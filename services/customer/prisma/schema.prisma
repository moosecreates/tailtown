generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "darwin-arm64"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AddOnService {
  id               String             @id
  name             String
  description      String?
  price            Float
  duration         Int?
  serviceId        String
  isActive         Boolean            @default(true)
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  organizationId   String
  ReservationAddOn ReservationAddOn[]

  @@index([organizationId])
  @@index([organizationId, isActive])
  @@index([serviceId])
  @@map("addon_services")
}

model Customer {
  id                 String        @id
  firstName          String
  lastName           String
  email              String
  phone              String?
  address            String?
  city               String?
  state              String?
  zipCode            String?
  notes              String?
  isActive           Boolean       @default(true)
  createdAt          DateTime      @default(now())
  updatedAt          DateTime
  Pet                Pet[]         @relation("CustomerToPet")
  Reservation        Reservation[]

  @@index([email], map: "customers_email_idx")
  @@index([phone], map: "customers_phone_idx")
  @@index([lastName, firstName], map: "customers_name_idx")
  @@map("customers")
}

model Pet {
  id                 String        @id
  name               String
  type               PetType
  breed              String?
  color              String?
  birthdate          DateTime?
  weight             Float?
  gender             Gender?
  isNeutered         Boolean       @default(false)
  microchipNumber    String?
  rabiesTagNumber    String?
  specialNeeds       String?
  foodNotes          String?
  medicationNotes    String?
  behaviorNotes      String?
  allergies          String?
  idealPlayGroup     PlayGroupType?
  vaccinationStatus  Json?
  vaccineExpirations Json?
  vetName            String?
  vetPhone           String?
  profilePhoto       String?
  isActive           Boolean       @default(true)
  lastCheckIn        DateTime?
  createdAt          DateTime      @default(now())
  updatedAt          DateTime
  customerId         String
  Customer           Customer     @relation("CustomerToPet", fields: [customerId], references: [id], onDelete: Cascade)
  Reservation        Reservation[]

  @@index([isActive, type], map: "pets_active_type_idx")
  @@index([customerId], map: "pets_customer_id_idx")
  @@index([lastCheckIn], map: "pets_last_checkin_idx")
  @@map("pets")
}

model Reservation {
  id               String             @id
  orderNumber      String?
  customerId       String
  petId            String
  resourceId       String?
  startDate        DateTime
  endDate          DateTime
  status           String             @default("CONFIRMED")
  suiteType        String
  price            Float?
  deposit          Float?
  balance          Float?
  notes            String?
  staffNotes       String?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  organizationId   String
  Customer         Customer           @relation(fields: [customerId], references: [id])
  Pet              Pet                @relation(fields: [petId], references: [id])
  Resource         Resource?          @relation(fields: [resourceId], references: [id])
  ReservationAddOn ReservationAddOn[]

  @@unique([orderNumber, organizationId])
  @@index([customerId])
  @@index([orderNumber])
  @@index([organizationId, customerId])
  @@index([organizationId])
  @@index([organizationId, startDate, endDate])
  @@index([organizationId, status])
  @@index([petId])
  @@index([resourceId])
  @@map("reservations")
}

model ReservationAddOn {
  id             String       @id
  reservationId  String
  addOnId        String
  price          Float
  notes          String?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime
  organizationId String
  AddOnService   AddOnService @relation(fields: [addOnId], references: [id])
  Reservation    Reservation  @relation(fields: [reservationId], references: [id])

  @@index([addOnId])
  @@index([organizationId])
  @@index([reservationId])
  @@map("reservation_addons")
}

model Resource {
  id             String        @id
  name           String
  type           String
  description    String?
  capacity       Int           @default(1)
  isActive       Boolean       @default(true)
  createdAt      DateTime      @default(now())
  updatedAt      DateTime
  organizationId String
  Reservation    Reservation[]

  @@index([organizationId])
  @@index([organizationId, isActive])
  @@index([organizationId, type])
  @@map("resources")
}

model Service {
  id             String   @id
  name           String
  description    String?
  price          Float
  duration       Int?
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime
  organizationId String

  @@index([organizationId])
  @@index([organizationId, isActive])
  @@map("services")
}


enum ReservationStatus {
  PENDING
  CONFIRMED
  CHECKED_IN
  CHECKED_OUT
  CANCELLED
  NO_SHOW
  COMPLETED
}

enum ResourceType {
  KENNEL
  RUN
  SUITE
  STANDARD_SUITE
  STANDARD_PLUS_SUITE
  VIP_SUITE
  PLAY_AREA
  OUTDOOR_PLAY_YARD
  PRIVATE_PLAY_AREA
  GROOMING_TABLE
  BATHING_STATION
  DRYING_STATION
  TRAINING_ROOM
  AGILITY_COURSE
  GROOMER
  TRAINER
  ATTENDANT
  BATHER
  OTHER
}

enum ServiceCategory {
  DAYCARE
  BOARDING
  GROOMING
  TRAINING
  OTHER
}

enum AvailabilityStatus {
  AVAILABLE
  RESERVED
  MAINTENANCE
  OUT_OF_SERVICE
}

enum ContactMethod {
  EMAIL
  SMS
  BOTH
  NONE
}

enum DiscountType {
  PERCENTAGE
  FIXED_AMOUNT
}

enum Gender {
  MALE
  FEMALE
  UNKNOWN
}

enum InvoiceStatus {
  DRAFT
  SENT
  PAID
  OVERDUE
  CANCELLED
  REFUNDED
  PARTIALLY_PAID
}

enum LedgerEntryType {
  DEPOSIT
  WITHDRAWAL
  ADJUSTMENT
  FEE
  INTEREST
  REFUND
  PAYMENT
}

enum PaymentMethod {
  CREDIT_CARD
  DEBIT_CARD
  CASH
  CHECK
  BANK_TRANSFER
  STORE_CREDIT
  GIFT_CARD
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum PetType {
  DOG
  CAT
  BIRD
  RABBIT
  REPTILE
  OTHER
}

enum PlayGroupType {
  SMALL_DOGS
  MEDIUM_DOGS
  LARGE_DOGS
  HIGH_ENERGY
  LOW_ENERGY
  PUPPIES
  SENIORS
  SPECIAL_NEEDS
}

enum PriceRuleType {
  DAY_OF_WEEK
  MULTI_DAY
  MULTI_PET
  SEASONAL
  PROMOTIONAL
  CUSTOM
}

enum ReconciliationFrequency {
  DAILY
  WEEKLY
  MONTHLY
}

enum ReconciliationStatus {
  IN_PROGRESS
  COMPLETED
  DISCREPANCIES_FOUND
  VERIFIED
  CANCELLED
}

enum ReconciliationType {
  DAILY
  WEEKLY
  MONTHLY
  MANUAL
  SYSTEM
}

enum ScheduleStatus {
  SCHEDULED
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum TimeOffStatus {
  PENDING
  APPROVED
  DENIED
  CANCELLED
}

enum TimeOffType {
  VACATION
  SICK
  PERSONAL
  BEREAVEMENT
  JURY_DUTY
  OTHER
}

enum TransactionStatus {
  PENDING
  COMPLETED
  FAILED
  VOIDED
  RECONCILED
  DISPUTED
}

enum TransactionType {
  PAYMENT
  REFUND
  ADJUSTMENT
  CREDIT
  DEBIT
  VOID
  FEE
  TAX
  DISCOUNT
}

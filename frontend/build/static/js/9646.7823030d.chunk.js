"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[9646],{39646:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var s=a(9950),n=a(62999),r=a(78317),i=a(82053),l=a(96463),o=a(89379),d=a(48089),c=a(45180),x=a(10226),u=a(50704),m=a(46639),h=a(65429),A=a(60899),y=a(25277),p=a(66699),j=a(96583),b=a(40033),g=a(28170),v=a(77922),C=a(8145),f=a(74745),P=a(25979),S=a(19647),I=a(70006),w=a(23266),k=a(249),W=a(26050),T=a(83563),D=a(79739),E=a(6163),M=a(31113),R=a(20227),N=a(28429),F=a(43974),H=a(46001),O=a(89007),_=a(35286),B=a(44414);const q=()=>{var e;const t=(0,N.Zp)(),[a,n]=(0,s.useState)([]),[l,q]=(0,s.useState)(!0),[z,L]=(0,s.useState)(null),[$,K]=(0,s.useState)(!1),[U,V]=(0,s.useState)(null),[G,Z]=(0,s.useState)([]),[J,Q]=(0,s.useState)([]),[X,Y]=(0,s.useState)(null),[ee,te]=(0,s.useState)(null),[ae,se]=(0,s.useState)(""),[ne,re]=(0,s.useState)({customerId:"",petId:"",amountPaid:0,paymentMethod:"CASH"}),[ie,le]=(0,s.useState)(!1),[oe,de]=(0,s.useState)(!1);(0,s.useEffect)(()=>{ce()},[]);const ce=async()=>{try{q(!0);const e=(await H.Ay.trainingClasses.getAll({status:"SCHEDULED",isActive:!0})).sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()).slice(0,6);n(e),L(null)}catch(e){L(e.message||"Failed to load classes"),console.error(e)}finally{q(!1)}},xe=e=>{const[t,a]=e.split(":").map(Number),s=t>=12?"PM":"AM";return"".concat(t%12||12,":").concat(a.toString().padStart(2,"0")," ").concat(s)},ue=()=>{K(!1),V(null),Y(null),te(null),se(""),Q([]),re({customerId:"",petId:"",amountPaid:0,paymentMethod:"CASH"})},me=async()=>{try{de(!0),await H.Ay.enrollments.enroll(U.id,{customerId:ne.customerId,petId:ne.petId,amountPaid:ne.amountPaid}),await ce(),ue(),le(!1),L(null),console.log("Enrollment successful!")}catch(a){var e,t;L((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||"Failed to enroll pet")}finally{de(!1)}},he=()=>{oe||le(!1)},Ae=()=>ne.amountPaid;return(0,B.jsxs)(d.A,{children:[(0,B.jsx)(c.A,{avatar:(0,B.jsx)(E.A,{color:"primary"}),title:"Upcoming Training Classes",subheader:"Active classes",action:(0,B.jsx)(x.A,{size:"small",endIcon:(0,B.jsx)(M.A,{}),onClick:()=>t("/training/classes"),children:"View All"}),sx:{pb:1}}),(0,B.jsx)(u.A,{sx:{pt:0,pb:2,"&:last-child":{pb:2}},children:l?(0,B.jsx)(r.A,{display:"flex",justifyContent:"center",p:3,children:(0,B.jsx)(m.A,{})}):z?(0,B.jsx)(h.A,{severity:"error",children:z}):0===a.length?(0,B.jsx)(i.A,{color:"textSecondary",align:"center",py:2,children:"No upcoming classes"}):(0,B.jsx)(A.Ay,{container:!0,spacing:2,children:a.map(e=>{var t;const a=(s=e.currentEnrolled,n=e.maxCapacity,s/n*100);var s,n,l;return(0,B.jsx)(A.Ay,{item:!0,xs:12,md:6,children:(0,B.jsxs)(r.A,{sx:{borderLeft:3,borderColor:"primary.main",p:1.5,bgcolor:"background.paper",borderRadius:1,height:"100%"},children:[(0,B.jsxs)(r.A,{display:"flex",alignItems:"center",gap:1,mb:.5,children:[(0,B.jsx)(i.A,{variant:"body2",fontWeight:"medium",sx:{flex:1},children:e.name}),(0,B.jsx)(y.A,{label:e.level,size:"small",color:"primary",variant:"outlined"})]}),(0,B.jsxs)(i.A,{variant:"caption",display:"block",color:"textSecondary",mb:.5,children:["Starts: ",(0,F.A)(new Date(e.startDate),"MMM dd, yyyy")]}),(0,B.jsxs)(i.A,{variant:"caption",display:"block",color:"textSecondary",mb:.5,children:[e.totalWeeks," weeks \u2022 ",e.category]}),(0,B.jsxs)(i.A,{variant:"caption",display:"block",color:"textSecondary",mb:1,children:[xe(e.startTime)," - ",xe(e.endTime)]}),(0,B.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5,children:[(0,B.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Enrollment"}),(0,B.jsxs)(i.A,{variant:"caption",fontWeight:"medium",children:[e.currentEnrolled," / ",e.maxCapacity]})]}),(0,B.jsx)(p.A,{variant:"determinate",value:a,color:(l=a,l>=90?"error":l>=70?"warning":"success"),sx:{height:4,borderRadius:2}}),(null===(t=e._count)||void 0===t?void 0:t.waitlist)&&e._count.waitlist>0&&(0,B.jsxs)(i.A,{variant:"caption",color:"warning.main",sx:{mt:.5,display:"block"},children:["+",e._count.waitlist," on waitlist"]}),(0,B.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,B.jsx)(R.A,{}),onClick:()=>(async e=>{V(e),Y(null),te(null),se(""),re({customerId:"",petId:"",amountPaid:e.pricePerSeries||0,paymentMethod:"CASH"});try{const e=await O.m.getAllCustomers(1,1e3);Z(e.data||[])}catch(t){console.error("Failed to load customers:",t)}K(!0)})(e),fullWidth:!0,sx:{mt:1.5},disabled:a>=100,children:a>=100?"Class Full":"Enroll Pet"})]})},e.id)})})}),(0,B.jsxs)(j.A,{open:$,onClose:ue,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsxs)(b.A,{children:["Enroll Pet in ",null===U||void 0===U?void 0:U.name]}),(0,B.jsxs)(g.A,{children:[z&&(0,B.jsx)(h.A,{severity:"error",onClose:()=>L(null),sx:{mb:2},children:z}),(0,B.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,B.jsx)(v.A,{options:G,value:X,onChange:(e,t)=>(async e=>{if(Y(e),te(null),e){re((0,o.A)((0,o.A)({},ne),{},{customerId:e.id,petId:""}));try{const t=await _.B.getPetsByCustomer(e.id);Q(t.data||[])}catch(t){console.error("Failed to load pets:",t),Q([])}}else re((0,o.A)((0,o.A)({},ne),{},{customerId:"",petId:""})),Q([])})(t),inputValue:ae,onInputChange:(e,t)=>se(t),getOptionLabel:e=>"".concat(e.firstName," ").concat(e.lastName," - ").concat(e.email),renderInput:e=>(0,B.jsx)(C.A,(0,o.A)((0,o.A)({},e),{},{label:"Search Customer",placeholder:"Type to search by name or email",required:!0})),renderOption:(e,t)=>(0,s.createElement)("li",(0,o.A)((0,o.A)({},e),{},{key:t.id}),(0,B.jsxs)(r.A,{children:[(0,B.jsxs)(i.A,{variant:"body2",children:[t.firstName," ",t.lastName]}),(0,B.jsxs)(i.A,{variant:"caption",color:"textSecondary",children:[t.email," \u2022 ",t.phone]})]})),noOptionsText:"No customers found",fullWidth:!0}),(0,B.jsx)(v.A,{options:J,value:ee,onChange:(e,t)=>{return te(a=t),void re(a?(0,o.A)((0,o.A)({},ne),{},{petId:a.id}):(0,o.A)((0,o.A)({},ne),{},{petId:""}));var a},getOptionLabel:e=>"".concat(e.name," (").concat(e.breed||"Pet",")"),renderInput:e=>(0,B.jsx)(C.A,(0,o.A)((0,o.A)({},e),{},{label:"Select Pet",placeholder:"Choose a pet",required:!0})),renderOption:(e,t)=>(0,s.createElement)("li",(0,o.A)((0,o.A)({},e),{},{key:t.id}),(0,B.jsxs)(r.A,{children:[(0,B.jsx)(i.A,{variant:"body2",children:t.name}),(0,B.jsxs)(i.A,{variant:"caption",color:"textSecondary",children:[t.breed||"Pet"," \u2022 ",t.type||"Unknown"]})]})),disabled:!X,noOptionsText:X?"No pets found for this customer":"Select a customer first",fullWidth:!0}),(0,B.jsx)(f.A,{sx:{my:1}}),(0,B.jsx)(i.A,{variant:"subtitle2",fontWeight:"bold",children:"Payment Information"}),(0,B.jsxs)(P.A,{fullWidth:!0,required:!0,children:[(0,B.jsx)(S.A,{children:"Payment Method"}),(0,B.jsxs)(I.A,{value:ne.paymentMethod,onChange:e=>re((0,o.A)((0,o.A)({},ne),{},{paymentMethod:e.target.value})),label:"Payment Method",children:[(0,B.jsx)(w.A,{value:"CASH",children:"Cash"}),(0,B.jsx)(w.A,{value:"CREDIT_CARD",children:"Credit Card"}),(0,B.jsx)(w.A,{value:"CHECK",children:"Check"})]})]}),(0,B.jsx)(C.A,{label:"Amount Paid",type:"number",value:ne.amountPaid,onChange:e=>re((0,o.A)((0,o.A)({},ne),{},{amountPaid:parseFloat(e.target.value)||0})),fullWidth:!0,required:!0,InputProps:{startAdornment:(0,B.jsx)(i.A,{sx:{mr:.5},children:"$"})},helperText:"Class price: $".concat((null===U||void 0===U?void 0:U.pricePerSeries)||0)}),(0,B.jsxs)(r.A,{sx:{p:2,bgcolor:"grey.100",borderRadius:1},children:[(0,B.jsx)(i.A,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:"Order Summary"}),(0,B.jsxs)(k.A,{dense:!0,disablePadding:!0,children:[(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Class"}),(0,B.jsx)(i.A,{variant:"body2",children:null===U||void 0===U?void 0:U.name})]}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Duration"}),(0,B.jsxs)(i.A,{variant:"body2",children:[null===U||void 0===U?void 0:U.totalWeeks," weeks"]})]}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Payment Method"}),(0,B.jsx)(i.A,{variant:"body2",children:(e=>{switch(e){case"CASH":return"Cash";case"CREDIT_CARD":return"Credit Card";case"CHECK":return"Check";default:return e}})(ne.paymentMethod)})]}),(0,B.jsx)(f.A,{sx:{my:1}}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:(0,B.jsx)(i.A,{variant:"subtitle2",fontWeight:"bold",children:"Total"})}),(0,B.jsxs)(i.A,{variant:"subtitle2",fontWeight:"bold",children:["$",Ae().toFixed(2)]})]})]})]}),U&&(0,B.jsx)(r.A,{sx:{p:2,bgcolor:"info.light",borderRadius:1},children:(0,B.jsxs)(i.A,{variant:"body2",color:"info.contrastText",children:[(0,B.jsx)("strong",{children:"Class Details:"}),(0,B.jsx)("br",{}),U.totalWeeks," weeks \u2022 ",(null===(e=U.daysOfWeek)||void 0===e?void 0:e.length)||1," days/week",(0,B.jsx)("br",{}),xe(U.startTime)," - ",xe(U.endTime),(0,B.jsx)("br",{}),"Capacity: ",U.currentEnrolled," / ",U.maxCapacity]})})]})]}),(0,B.jsxs)(D.A,{children:[(0,B.jsx)(x.A,{onClick:ue,children:"Cancel"}),(0,B.jsx)(x.A,{onClick:async()=>{ne.customerId&&ne.petId&&U?ne.amountPaid<=0?L("Payment amount must be greater than zero"):"CREDIT_CARD"!==ne.paymentMethod?await me():le(!0):L("Please select both customer and pet")},variant:"contained",color:"success",disabled:!ne.customerId||!ne.petId||ne.amountPaid<=0,children:"Complete Enrollment & Payment"})]})]}),(0,B.jsxs)(j.A,{open:ie,onClose:he,maxWidth:"sm",fullWidth:!0,disableEscapeKeyDown:oe,children:[(0,B.jsx)(b.A,{children:"Credit Card Payment"}),(0,B.jsx)(g.A,{children:(0,B.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,B.jsxs)(r.A,{sx:{p:2,bgcolor:"grey.100",borderRadius:1},children:[(0,B.jsx)(i.A,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:"Payment Summary"}),(0,B.jsxs)(k.A,{dense:!0,disablePadding:!0,children:[(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Customer"}),(0,B.jsxs)(i.A,{variant:"body2",children:[null===X||void 0===X?void 0:X.firstName," ",null===X||void 0===X?void 0:X.lastName]})]}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Pet"}),(0,B.jsx)(i.A,{variant:"body2",children:null===ee||void 0===ee?void 0:ee.name})]}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:"Class"}),(0,B.jsx)(i.A,{variant:"body2",children:null===U||void 0===U?void 0:U.name})]}),(0,B.jsx)(f.A,{sx:{my:1}}),(0,B.jsxs)(W.Ay,{disablePadding:!0,children:[(0,B.jsx)(T.A,{primary:(0,B.jsx)(i.A,{variant:"subtitle1",fontWeight:"bold",children:"Amount to Charge"})}),(0,B.jsxs)(i.A,{variant:"subtitle1",fontWeight:"bold",color:"primary",children:["$",Ae().toFixed(2)]})]})]})]}),(0,B.jsxs)(r.A,{sx:{p:3,border:"2px dashed",borderColor:"grey.300",borderRadius:1,textAlign:"center"},children:[(0,B.jsx)(i.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Credit Card Processing"}),(0,B.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"In production, this would integrate with Stripe, Square, or your payment processor"}),oe&&(0,B.jsxs)(r.A,{sx:{mt:2},children:[(0,B.jsx)(m.A,{size:24}),(0,B.jsx)(i.A,{variant:"body2",sx:{mt:1},children:"Processing payment..."})]})]}),(0,B.jsx)(h.A,{severity:"info",children:(0,B.jsxs)(i.A,{variant:"body2",children:[(0,B.jsx)("strong",{children:"Demo Mode:"}),' Click "Process Payment" to simulate a successful credit card transaction.']})})]})}),(0,B.jsxs)(D.A,{children:[(0,B.jsx)(x.A,{onClick:he,disabled:oe,children:"Cancel"}),(0,B.jsx)(x.A,{onClick:async()=>{de(!0);try{await new Promise(e=>setTimeout(e,2e3)),await me()}catch(e){L("Payment processing failed. Please try again."),de(!1)}},variant:"contained",color:"primary",disabled:oe,children:oe?"Processing...":"Process Payment"})]})]})]})};var z=a(78114);const L=()=>(0,B.jsxs)(n.A,{maxWidth:"xl",children:[(0,B.jsx)(r.A,{sx:{mt:4,mb:2},children:(0,B.jsx)(i.A,{variant:"h4",gutterBottom:!0,children:"Training Calendar"})}),(0,B.jsx)(r.A,{sx:{mb:3},children:(0,B.jsx)(q,{})}),(0,B.jsx)(l.A,{serviceCategories:[z.e.TRAINING],calendarTitle:"Training Calendar"})]})}}]);
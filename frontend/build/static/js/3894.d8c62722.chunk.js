"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[3894],{73894:(e,n,s)=>{s.r(n),s.d(n,{default:()=>H});var t=s(89379),l=s(80045),i=s(9950),a=s(78317),o=s(62999),c=s(82053),r=s(10226),d=s(65429),x=s(2235),h=s(69019),u=s(84142),A=s(46639),p=s(99532),j=s(37736),v=s(60899),m=s(8145),g=s(16497),b=s(37324),y=s(74616),f=s(46986),C=s(25333),T=s(45546),k=s(25979),S=s(19647),w=s(70006),I=s(23266),q=s(18726),E=s(57988),D=s(80504),O=s(44414);const N=[{value:"TEXT",label:"Short Text"},{value:"LONG_TEXT",label:"Long Text"},{value:"YES_NO",label:"Yes/No"},{value:"MULTIPLE_CHOICE",label:"Multiple Choice"},{value:"TIME",label:"Time"},{value:"DATE",label:"Date"}],B=e=>{var n;let{template:s,onSave:l,onCancel:o}=e;const[d,h]=(0,i.useState)(s),u=(e,n)=>{h((0,t.A)((0,t.A)({},d),{},{[e]:n}))},A=(e,n,s)=>{const l=[...d.sections];l[e]=(0,t.A)((0,t.A)({},l[e]),{},{[n]:s}),h((0,t.A)((0,t.A)({},d),{},{sections:l}))},j=(e,n,s,l)=>{const i=[...d.sections];i[e].questions[n]=(0,t.A)((0,t.A)({},i[e].questions[n]),{},{[s]:l}),h((0,t.A)((0,t.A)({},d),{},{sections:i}))};return(0,O.jsxs)(a.A,{sx:{p:3},children:[(0,O.jsxs)(a.A,{sx:{mb:4},children:[(0,O.jsx)(c.A,{variant:"h5",gutterBottom:!0,children:d.id?"Edit Template":"Create Template"}),(0,O.jsxs)(v.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsx)(m.A,{fullWidth:!0,label:"Template Name",value:d.name,onChange:e=>u("name",e.target.value),required:!0})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsxs)(a.A,{sx:{display:"flex",gap:2,alignItems:"center",height:"100%"},children:[(0,O.jsx)(g.A,{control:(0,O.jsx)(b.A,{checked:d.isDefault,onChange:e=>u("isDefault",e.target.checked)}),label:"Default Template"}),(0,O.jsx)(g.A,{control:(0,O.jsx)(b.A,{checked:d.isActive,onChange:e=>u("isActive",e.target.checked)}),label:"Active"})]})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,children:(0,O.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:2,label:"Description",value:d.description,onChange:e=>u("description",e.target.value)})})]})]}),(0,O.jsxs)(a.A,{sx:{mb:3},children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,O.jsx)(c.A,{variant:"h6",children:"Sections"}),(0,O.jsx)(r.A,{startIcon:(0,O.jsx)(p.A,{}),onClick:()=>{var e;const n={title:"New Section",description:"",order:((null===(e=d.sections)||void 0===e?void 0:e.length)||0)+1,questions:[]};h((0,t.A)((0,t.A)({},d),{},{sections:[...d.sections||[],n]}))},variant:"outlined",children:"Add Section"})]}),null===(n=d.sections)||void 0===n?void 0:n.map((e,n)=>{var s;return(0,O.jsxs)(y.A,{defaultExpanded:0===n,children:[(0,O.jsx)(f.A,{expandIcon:(0,O.jsx)(q.A,{}),children:(0,O.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,O.jsx)(D.A,{sx:{mr:1,color:"text.secondary"}}),(0,O.jsx)(c.A,{sx:{flexGrow:1},children:e.title}),(0,O.jsx)(C.A,{size:"small",onClick:e=>{e.stopPropagation(),(e=>{const n=d.sections.filter((n,s)=>s!==e);h((0,t.A)((0,t.A)({},d),{},{sections:n}))})(n)},children:(0,O.jsx)(E.A,{})})]})}),(0,O.jsx)(T.A,{children:(0,O.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,O.jsx)(m.A,{fullWidth:!0,label:"Section Title",value:e.title,onChange:e=>A(n,"title",e.target.value)}),(0,O.jsx)(m.A,{fullWidth:!0,label:"Section Description",value:e.description,onChange:e=>A(n,"description",e.target.value)}),(0,O.jsxs)(a.A,{sx:{mt:2},children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,O.jsx)(c.A,{variant:"subtitle1",children:"Questions"}),(0,O.jsx)(r.A,{size:"small",startIcon:(0,O.jsx)(p.A,{}),onClick:()=>(e=>{var n;const s={questionText:"New Question",questionType:"TEXT",isRequired:!1,order:((null===(n=d.sections[e].questions)||void 0===n?void 0:n.length)||0)+1,placeholder:"",helpText:"",options:null},l=[...d.sections];l[e].questions=[...l[e].questions||[],s],h((0,t.A)((0,t.A)({},d),{},{sections:l}))})(n),children:"Add Question"})]}),null===(s=e.questions)||void 0===s?void 0:s.map((e,s)=>{var l,i;return(0,O.jsxs)(x.A,{sx:{p:2,mb:2,bgcolor:"grey.50"},children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,O.jsxs)(c.A,{variant:"subtitle2",children:["Question ",s+1]}),(0,O.jsx)(C.A,{size:"small",onClick:()=>((e,n)=>{const s=[...d.sections];s[e].questions=s[e].questions.filter((e,s)=>s!==n),h((0,t.A)((0,t.A)({},d),{},{sections:s}))})(n,s),children:(0,O.jsx)(E.A,{})})]}),(0,O.jsxs)(v.Ay,{container:!0,spacing:2,children:[(0,O.jsx)(v.Ay,{item:!0,xs:12,children:(0,O.jsx)(m.A,{fullWidth:!0,label:"Question Text",value:e.questionText,onChange:e=>j(n,s,"questionText",e.target.value)})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsxs)(k.A,{fullWidth:!0,children:[(0,O.jsx)(S.A,{children:"Question Type"}),(0,O.jsx)(w.A,{value:e.questionType,label:"Question Type",onChange:e=>j(n,s,"questionType",e.target.value),children:N.map(e=>(0,O.jsx)(I.A,{value:e.value,children:e.label},e.value))})]})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsx)(g.A,{control:(0,O.jsx)(b.A,{checked:e.isRequired,onChange:e=>j(n,s,"isRequired",e.target.checked)}),label:"Required"})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsx)(m.A,{fullWidth:!0,label:"Placeholder",value:e.placeholder||"",onChange:e=>j(n,s,"placeholder",e.target.value)})}),(0,O.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,O.jsx)(m.A,{fullWidth:!0,label:"Help Text",value:e.helpText||"",onChange:e=>j(n,s,"helpText",e.target.value)})}),"MULTIPLE_CHOICE"===e.questionType&&(0,O.jsxs)(v.Ay,{item:!0,xs:12,children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,O.jsx)(c.A,{variant:"body2",fontWeight:"bold",children:"Answer Choices"}),(0,O.jsx)(r.A,{size:"small",onClick:()=>((e,n)=>{var s;const l=[...d.sections],i=l[e].questions[n],a=(null===(s=i.options)||void 0===s?void 0:s.choices)||[];i.options={choices:[...a,"New Option"]},h((0,t.A)((0,t.A)({},d),{},{sections:l}))})(n,s),children:"Add Choice"})]}),null===(l=e.options)||void 0===l||null===(i=l.choices)||void 0===i?void 0:i.map((e,l)=>(0,O.jsxs)(a.A,{sx:{display:"flex",gap:1,mb:1},children:[(0,O.jsx)(m.A,{fullWidth:!0,size:"small",value:e,onChange:e=>((e,n,s,l)=>{const i=[...d.sections];i[e].questions[n].options.choices[s]=l,h((0,t.A)((0,t.A)({},d),{},{sections:i}))})(n,s,l,e.target.value)}),(0,O.jsx)(C.A,{size:"small",onClick:()=>((e,n,s)=>{const l=[...d.sections],i=l[e].questions[n];i.options.choices=i.options.choices.filter((e,n)=>n!==s),h((0,t.A)((0,t.A)({},d),{},{sections:l}))})(n,s,l),children:(0,O.jsx)(E.A,{})})]},l))]})]})]},s)})]})]})})]},n)})]}),(0,O.jsxs)(a.A,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:4},children:[(0,O.jsx)(r.A,{variant:"outlined",onClick:o,children:"Cancel"}),(0,O.jsx)(r.A,{variant:"contained",onClick:()=>l(d),children:"Save Template"})]})]})};var U=s(249),z=s(26050),M=s(83563),W=s(71378),L=s(74745),_=s(7999);const P=["children","value","index"];function R(e){const{children:n,value:s,index:i}=e,o=(0,l.A)(e,P);return(0,O.jsx)("div",(0,t.A)((0,t.A)({role:"tabpanel",hidden:s!==i,id:"config-tabpanel-".concat(i),"aria-labelledby":"config-tab-".concat(i)},o),{},{children:s===i&&(0,O.jsx)(a.A,{sx:{py:2},children:n})}))}const F=()=>{const[e,n]=(0,i.useState)(0),[s,l]=(0,i.useState)([{value:"ORAL",label:"Oral"},{value:"TOPICAL",label:"Topical"},{value:"INJECTION",label:"Injection"},{value:"EYE_DROPS",label:"Eye Drops"},{value:"EAR_DROPS",label:"Ear Drops"},{value:"OTHER",label:"Other"}]),[o,A]=(0,i.useState)([{type:"Collar",icon:"\ud83d\udd17"},{type:"Leash",icon:"\ud83e\uddae"},{type:"Toy",icon:"\ud83c\udfbe"},{type:"Bedding",icon:"\ud83d\udecf\ufe0f"},{type:"Food",icon:"\ud83c\udf56"},{type:"Bowl",icon:"\ud83e\udd63"},{type:"Medication",icon:"\ud83d\udc8a"},{type:"Treats",icon:"\ud83e\uddb4"}]),[j,v]=(0,i.useState)(null),[g,b]=(0,i.useState)(null),[y,f]=(0,i.useState)(""),[T,k]=(0,i.useState)(""),[S,w]=(0,i.useState)(""),[I,q]=(0,i.useState)("");return(0,O.jsxs)(a.A,{sx:{p:3},children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,O.jsx)(c.A,{variant:"h6",children:"Pre-populated Options Configuration"}),(0,O.jsx)(r.A,{variant:"contained",onClick:()=>{alert("Configuration saved! (Backend integration pending)")},children:"Save Configuration"})]}),(0,O.jsx)(d.A,{severity:"info",sx:{mb:3},children:"Configure the pre-populated options that appear in dropdowns and quick-add buttons throughout the check-in process."}),(0,O.jsxs)(x.A,{children:[(0,O.jsxs)(h.A,{value:e,onChange:(e,s)=>{n(s)},children:[(0,O.jsx)(u.A,{label:"Medication Methods"}),(0,O.jsx)(u.A,{label:"Common Belongings"})]}),(0,O.jsx)(R,{value:e,index:0,children:(0,O.jsxs)(a.A,{sx:{p:2},children:[(0,O.jsx)(c.A,{variant:"subtitle1",gutterBottom:!0,children:"Medication Administration Methods"}),(0,O.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"These options appear in the medication administration method dropdown during check-in."}),(0,O.jsxs)(x.A,{sx:{p:2,mb:3,bgcolor:"grey.50"},children:[(0,O.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:j?"Edit Method":"Add New Method"}),(0,O.jsxs)(a.A,{sx:{display:"flex",gap:2,mb:2},children:[(0,O.jsx)(m.A,{size:"small",label:"Value (CODE)",value:y,onChange:e=>f(e.target.value),placeholder:"e.g., SUBCUTANEOUS",helperText:"Internal code (uppercase, underscores)"}),(0,O.jsx)(m.A,{size:"small",label:"Display Label",value:T,onChange:e=>k(e.target.value),placeholder:"e.g., Subcutaneous Injection",helperText:"User-friendly label",sx:{flexGrow:1}}),j?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.A,{variant:"contained",onClick:()=>{if(j&&y&&T){const e=[...s];e[j.index]={value:y.toUpperCase().replace(/\s+/g,"_"),label:T},l(e),v(null),f(""),k("")}},children:"Update"}),(0,O.jsx)(r.A,{variant:"outlined",onClick:()=>{v(null),f(""),k("")},children:"Cancel"})]}):(0,O.jsx)(r.A,{variant:"contained",startIcon:(0,O.jsx)(p.A,{}),onClick:()=>{y&&T&&(l([...s,{value:y.toUpperCase().replace(/\s+/g,"_"),label:T}]),f(""),k(""))},children:"Add"})]})]}),(0,O.jsx)(U.A,{children:s.map((e,n)=>(0,O.jsxs)(i.Fragment,{children:[(0,O.jsxs)(z.Ay,{children:[(0,O.jsx)(M.A,{primary:e.label,secondary:"Code: ".concat(e.value)}),(0,O.jsxs)(W.A,{children:[(0,O.jsx)(C.A,{edge:"end",onClick:()=>((e,n)=>{v((0,t.A)((0,t.A)({},e),{},{index:n})),f(e.value),k(e.label)})(e,n),sx:{mr:1},children:(0,O.jsx)(_.A,{})}),(0,O.jsx)(C.A,{edge:"end",onClick:()=>(e=>{l(s.filter((n,s)=>s!==e))})(n),children:(0,O.jsx)(E.A,{})})]})]}),n<s.length-1&&(0,O.jsx)(L.A,{})]},n))})]})}),(0,O.jsx)(R,{value:e,index:1,children:(0,O.jsxs)(a.A,{sx:{p:2},children:[(0,O.jsx)(c.A,{variant:"subtitle1",gutterBottom:!0,children:"Common Belongings Items"}),(0,O.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"These items appear as quick-add buttons in the belongings inventory during check-in."}),(0,O.jsxs)(x.A,{sx:{p:2,mb:3,bgcolor:"grey.50"},children:[(0,O.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:g?"Edit Item":"Add New Item"}),(0,O.jsxs)(a.A,{sx:{display:"flex",gap:2,mb:2},children:[(0,O.jsx)(m.A,{size:"small",label:"Item Type",value:S,onChange:e=>w(e.target.value),placeholder:"e.g., Harness",helperText:"Item name",sx:{flexGrow:1}}),(0,O.jsx)(m.A,{size:"small",label:"Icon (Emoji)",value:I,onChange:e=>q(e.target.value),placeholder:"e.g., \ud83c\udf92",helperText:"Single emoji",sx:{width:120}}),g?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.A,{variant:"contained",onClick:()=>{if(g&&S){const e=[...o];e[g.index]={type:S,icon:I||"\ud83d\udce6"},A(e),b(null),w(""),q("")}},children:"Update"}),(0,O.jsx)(r.A,{variant:"outlined",onClick:()=>{b(null),w(""),q("")},children:"Cancel"})]}):(0,O.jsx)(r.A,{variant:"contained",startIcon:(0,O.jsx)(p.A,{}),onClick:()=>{S&&(A([...o,{type:S,icon:I||"\ud83d\udce6"}]),w(""),q(""))},children:"Add"})]})]}),(0,O.jsx)(U.A,{children:o.map((e,n)=>(0,O.jsxs)(i.Fragment,{children:[(0,O.jsxs)(z.Ay,{children:[(0,O.jsx)(M.A,{primary:"".concat(e.icon," ").concat(e.type),secondary:"Icon: ".concat(e.icon)}),(0,O.jsxs)(W.A,{children:[(0,O.jsx)(C.A,{edge:"end",onClick:()=>((e,n)=>{b((0,t.A)((0,t.A)({},e),{},{index:n})),w(e.type),q(e.icon)})(e,n),sx:{mr:1},children:(0,O.jsx)(_.A,{})}),(0,O.jsx)(C.A,{edge:"end",onClick:()=>(e=>{A(o.filter((n,s)=>s!==e))})(n),children:(0,O.jsx)(E.A,{})})]})]}),n<o.length-1&&(0,O.jsx)(L.A,{})]},n))})]})})]})]})},Q=["children","value","index"];function G(e){const{children:n,value:s,index:i}=e,o=(0,l.A)(e,Q);return(0,O.jsx)("div",(0,t.A)((0,t.A)({role:"tabpanel",hidden:s!==i,id:"tabpanel-".concat(i),"aria-labelledby":"tab-".concat(i)},o),{},{children:s===i&&(0,O.jsx)(a.A,{sx:{py:3},children:n})}))}const H=()=>{const[e,n]=(0,i.useState)(0),[s,t]=(0,i.useState)([]),[l,v]=(0,i.useState)(!0),[m,g]=(0,i.useState)(null),[b,y]=(0,i.useState)(null);(0,i.useEffect)(()=>{f()},[]);const f=async()=>{try{v(!0);const e=await j.A.getAllTemplates();t(e.data||[]),g(null)}catch(e){g("Failed to load templates: "+(e.message||"Unknown error"))}finally{v(!1)}};return(0,O.jsx)(o.A,{maxWidth:"xl",children:(0,O.jsxs)(a.A,{sx:{py:4},children:[(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,O.jsx)(c.A,{variant:"h4",component:"h1",children:"Check-In Configuration"}),(0,O.jsx)(r.A,{variant:"contained",startIcon:(0,O.jsx)(p.A,{}),onClick:()=>{y({name:"New Template",description:"",isDefault:!1,isActive:!0,sections:[]})},children:"New Template"})]}),m&&(0,O.jsx)(d.A,{severity:"error",sx:{mb:3},onClose:()=>g(null),children:m}),(0,O.jsxs)(x.A,{sx:{width:"100%"},children:[(0,O.jsxs)(h.A,{value:e,onChange:(e,s)=>{n(s)},"aria-label":"check-in configuration tabs",children:[(0,O.jsx)(u.A,{label:"Templates"}),(0,O.jsx)(u.A,{label:"Pre-populated Options"}),(0,O.jsx)(u.A,{label:"Settings"})]}),(0,O.jsx)(G,{value:e,index:0,children:l?(0,O.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,O.jsx)(A.A,{})}):b?(0,O.jsx)(B,{template:b,onSave:async e=>{try{if(e.id){const n={name:e.name,description:e.description,isActive:e.isActive,isDefault:e.isDefault,sections:e.sections};console.log("Saving template:",e.id,n),await j.A.updateTemplate(e.id,n)}else await j.A.createTemplate(e);await f(),y(null),g(null)}catch(t){var n,s;console.error("Save error:",t),g("Failed to save template: "+((null===(n=t.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.error)||t.message||"Unknown error"))}},onCancel:()=>{y(null)}}):(0,O.jsxs)(a.A,{sx:{p:3},children:[(0,O.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Available Templates"}),0===s.length?(0,O.jsx)(d.A,{severity:"info",children:"No templates found. Create your first template to get started."}):(0,O.jsx)(a.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:s.map(e=>(0,O.jsx)(x.A,{sx:{p:2,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:()=>(e=>{y(e)})(e),children:(0,O.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,O.jsxs)(a.A,{children:[(0,O.jsxs)(c.A,{variant:"h6",children:[e.name,e.isDefault&&(0,O.jsx)(c.A,{component:"span",color:"primary",sx:{ml:1,fontSize:"0.875rem"},children:"(Default)"})]}),(0,O.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.description})]}),(0,O.jsx)(c.A,{variant:"body2",color:e.isActive?"success.main":"text.disabled",children:e.isActive?"Active":"Inactive"})]})},e.id))})]})}),(0,O.jsx)(G,{value:e,index:1,children:(0,O.jsx)(F,{})}),(0,O.jsx)(G,{value:e,index:2,children:(0,O.jsxs)(a.A,{sx:{p:3},children:[(0,O.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"General Settings"}),(0,O.jsx)(d.A,{severity:"info",children:"Settings configuration coming soon..."})]})})]})]})})}}}]);
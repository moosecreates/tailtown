"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[758],{60758:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var n=t(9950),r=t(78317),l=t(46639),a=t(65429),i=t(82053),c=t(10226),o=t(2235),d=t(69019),x=t(84142),A=t(1320),h=t(15769),j=t(69780),u=t(9213),m=t(21671),y=t(34075),f=t(25277),p=t(83274),g=t(25333),C=t(49885),v=t(11227),w=t(12960),b=t(28429),E=t(46001),S=t(44414);const k=()=>{const{classId:e}=(0,b.g)(),s=(0,b.Zp)(),[t,k]=(0,n.useState)(null),[D,P]=(0,n.useState)([]),[I,L]=(0,n.useState)(!0),[T,N]=(0,n.useState)(null),[z,M]=(0,n.useState)(0);(0,n.useEffect)(()=>{e&&O()},[e]);const O=async()=>{try{L(!0);const s=await E.Ay.trainingClasses.getById(e);k(s),P([]),N(null)}catch(s){N(s.message||"Failed to load data"),console.error(s)}finally{L(!1)}},F=e=>{switch(e){case"ACTIVE":return"success";case"COMPLETED":return"info";case"CANCELLED":return"error";case"PENDING":return"warning";default:return"default"}},R=e=>{switch(e){case"PAID":return"success";case"PARTIAL":return"warning";case"PENDING":return"error";default:return"default"}};if(I)return(0,S.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,S.jsx)(l.A,{})});if(!t)return(0,S.jsx)(r.A,{p:3,children:(0,S.jsx)(a.A,{severity:"error",children:"Training class not found"})});const V=D.filter(e=>"ACTIVE"===e.status||"ENROLLED"===e.status),B=D.filter(e=>"COMPLETED"===e.status),G=D.filter(e=>"DROPPED"===e.status);return(0,S.jsxs)(r.A,{children:[(0,S.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"h4",children:t.name}),(0,S.jsxs)(i.A,{variant:"body2",color:"textSecondary",children:["Enrollments: ",V.length," / ",t.maxCapacity]})]}),(0,S.jsx)(c.A,{variant:"outlined",onClick:()=>s("/training/classes"),children:"Back to Classes"})]}),T&&(0,S.jsx)(a.A,{severity:"error",onClose:()=>N(null),sx:{mb:2},children:T}),(0,S.jsx)(o.A,{sx:{p:2,mb:2},children:(0,S.jsxs)(r.A,{display:"flex",gap:3,children:[(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Category"}),(0,S.jsx)(i.A,{variant:"body1",children:t.category})]}),(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Level"}),(0,S.jsx)(i.A,{variant:"body1",children:t.level})]}),(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Schedule"}),(0,S.jsxs)(i.A,{variant:"body1",children:[t.startTime," - ",t.endTime]})]}),(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Duration"}),(0,S.jsxs)(i.A,{variant:"body1",children:[t.totalWeeks," weeks"]})]}),(0,S.jsxs)(r.A,{children:[(0,S.jsx)(i.A,{variant:"caption",color:"textSecondary",children:"Price"}),(0,S.jsxs)(i.A,{variant:"body1",children:["$",t.pricePerSeries]})]})]})}),(0,S.jsx)(o.A,{sx:{mb:2},children:(0,S.jsxs)(d.A,{value:z,onChange:(e,s)=>M(s),children:[(0,S.jsx)(x.A,{label:"Active (".concat(V.length,")")}),(0,S.jsx)(x.A,{label:"Completed (".concat(B.length,")")}),(0,S.jsx)(x.A,{label:"Cancelled (".concat(G.length,")")})]})}),(0,S.jsx)(o.A,{children:(0,S.jsx)(A.A,{children:(0,S.jsxs)(h.A,{children:[(0,S.jsx)(j.A,{children:(0,S.jsxs)(u.A,{children:[(0,S.jsx)(m.A,{children:"Pet"}),(0,S.jsx)(m.A,{children:"Customer"}),(0,S.jsx)(m.A,{children:"Enrolled Date"}),(0,S.jsx)(m.A,{children:"Payment"}),(0,S.jsx)(m.A,{children:"Progress"}),(0,S.jsx)(m.A,{children:"Status"}),(0,S.jsx)(m.A,{align:"right",children:"Actions"})]})}),(0,S.jsx)(y.A,{children:0===(0===z?V:1===z?B:G).length?(0,S.jsx)(u.A,{children:(0,S.jsx)(m.A,{colSpan:7,align:"center",children:(0,S.jsx)(i.A,{color:"textSecondary",py:4,children:"No enrollments in this category"})})}):(0===z?V:1===z?B:G).map(e=>{var s;return(0,S.jsxs)(u.A,{children:[(0,S.jsx)(m.A,{children:(null===(s=e.pet)||void 0===s?void 0:s.name)||"Unknown"}),(0,S.jsx)(m.A,{children:e.customer?"".concat(e.customer.firstName," ").concat(e.customer.lastName):"Unknown"}),(0,S.jsx)(m.A,{children:new Date(e.enrollmentDate).toLocaleDateString()}),(0,S.jsxs)(m.A,{children:[(0,S.jsx)(f.A,{label:e.paymentStatus,color:R(e.paymentStatus),size:"small"}),(0,S.jsxs)(i.A,{variant:"caption",display:"block",children:["$",e.amountPaid]})]}),(0,S.jsx)(m.A,{children:(0,S.jsxs)(i.A,{variant:"body2",children:[e.sessionsAttended||0," / ",t.totalWeeks," sessions"]})}),(0,S.jsxs)(m.A,{children:[(0,S.jsx)(f.A,{label:e.status,color:F(e.status),size:"small"}),e.certificateIssued&&(0,S.jsx)(f.A,{icon:(0,S.jsx)(w.A,{}),label:"Certified",size:"small",color:"success",sx:{ml:1}})]}),(0,S.jsxs)(m.A,{align:"right",children:["ACTIVE"===e.status&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(p.A,{title:"Mark Complete",children:(0,S.jsx)(g.A,{size:"small",onClick:()=>(async e=>{if(window.confirm("Mark this enrollment as completed?"))try{await E.Ay.enrollments.update(e,{status:"COMPLETED"}),await O()}catch(s){N(s.message||"Failed to complete enrollment")}})(e.id),color:"success",children:(0,S.jsx)(v.A,{})})}),(0,S.jsx)(p.A,{title:"Cancel",children:(0,S.jsx)(g.A,{size:"small",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to drop this enrollment?"))try{await E.Ay.enrollments.drop(e),await O()}catch(s){N(s.message||"Failed to drop enrollment")}})(e.id),color:"error",children:(0,S.jsx)(C.A,{})})})]}),"COMPLETED"===e.status&&!e.certificateIssued&&(0,S.jsx)(p.A,{title:"Issue Certificate",children:(0,S.jsx)(g.A,{size:"small",onClick:()=>(async e=>{try{await E.Ay.enrollments.issueCertificate(e),await O(),alert("Certificate issued successfully!")}catch(s){N(s.message||"Failed to issue certificate")}})(e.id),color:"primary",children:(0,S.jsx)(w.A,{})})})]})]},e.id)})})]})})})]})}}}]);
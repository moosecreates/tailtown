"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[5541],{95541:(e,t,d)=>{d.r(t),d.d(t,{default:()=>I});var i=d(89379),r=d(80045),n=d(9950),s=d(78317),l=d(46639),a=d(82053),o=d(62999),x=d(25979),c=d(19647),h=d(70006),p=d(23266),j=d(60899),g=d(2235),v=d(69019),A=d(84142),u=d(48089),y=d(45180),m=d(50704),b=d(14857),f=d(25102),T=d(16335),B=d(81095),S=d(72528),k=d(54203),w=d(93245),R=d(85706),C=d(60158),O=d(44813),W=d(80294),F=d(67360),P=d(60229),z=d(81298),D=d(44414);const K=["children","value","index"],E=e=>{const{children:t,value:d,index:n}=e,l=(0,r.A)(e,K);return(0,D.jsx)("div",(0,i.A)((0,i.A)({role:"tabpanel",hidden:d!==n,id:"analytics-tabpanel-".concat(n),"aria-labelledby":"analytics-tab-".concat(n)},l),{},{children:d===n&&(0,D.jsx)(s.A,{sx:{p:3},children:t})}))},I=()=>{const e=(0,b.A)(),[t,d]=(0,n.useState)(!0),[i,r]=(0,n.useState)("month"),[K,I]=(0,n.useState)(0),[L,M]=(0,n.useState)(null),[N,X]=(0,n.useState)(null),[Y,_]=(0,n.useState)(null),[G,U]=(0,n.useState)(null),$=[e.palette.primary.main,e.palette.secondary.main,e.palette.success.main,e.palette.warning.main,e.palette.error.main,e.palette.info.main,"#8884d8","#82ca9d","#ffc658","#ff8042"],q=(0,n.useCallback)(async()=>{d(!0),U(null);try{const[e,t,d]=await Promise.all([P.A.getDashboardSummary(i),P.A.getSalesByService(i),P.A.getSalesByAddOn(i)]);M(e),X(t),_(d)}catch(e){console.error("Error loading analytics data:",e),U("Failed to load analytics data. Please try again.")}finally{d(!1)}},[i]);(0,n.useEffect)(()=>{q()},[q]);const H=()=>{switch(i){case"day":return"Today";case"week":return"This Week";case"month":return"This Month";case"year":return"This Year";case"all":return"All Time";default:return"Custom Period"}};return t?(0,D.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,D.jsx)(l.A,{})}):G?(0,D.jsx)(s.A,{sx:{p:3,color:"error.main"},children:(0,D.jsx)(a.A,{variant:"h6",children:G})}):(0,D.jsxs)(o.A,{maxWidth:"xl",children:[(0,D.jsxs)(s.A,{sx:{mb:4},children:[(0,D.jsx)(a.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Sales Dashboard"}),(0,D.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,D.jsx)(a.A,{variant:"subtitle1",color:"text.secondary",children:"Gain insights into your business performance and customer behavior"}),(0,D.jsxs)(x.A,{sx:{minWidth:150},children:[(0,D.jsx)(c.A,{id:"period-select-label",children:"Time Period"}),(0,D.jsxs)(h.A,{labelId:"period-select-label",id:"period-select",value:i,label:"Time Period",onChange:e=>{r(e.target.value)},children:[(0,D.jsx)(p.A,{value:"day",children:"Today"}),(0,D.jsx)(p.A,{value:"week",children:"This Week"}),(0,D.jsx)(p.A,{value:"month",children:"This Month"}),(0,D.jsx)(p.A,{value:"year",children:"This Year"}),(0,D.jsx)(p.A,{value:"all",children:"All Time"})]})]})]})]}),L&&(0,D.jsx)(s.A,{sx:{mb:4},children:(0,D.jsxs)(j.Ay,{container:!0,spacing:3,children:[(0,D.jsx)(j.Ay,{item:!0,xs:12,md:3,children:(0,D.jsxs)(g.A,{elevation:2,sx:{p:2,borderRadius:2,height:"100%"},children:[(0,D.jsx)(a.A,{variant:"subtitle2",color:"text.secondary",children:"Total Revenue"}),(0,D.jsx)(a.A,{variant:"h4",sx:{mt:1,color:"primary.main"},children:(0,z.vv)(L.totalRevenue,!0)}),(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:H()})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,md:3,children:(0,D.jsxs)(g.A,{elevation:2,sx:{p:2,borderRadius:2,height:"100%"},children:[(0,D.jsx)(a.A,{variant:"subtitle2",color:"text.secondary",children:"Active Customers"}),(0,D.jsx)(a.A,{variant:"h4",sx:{mt:1,color:"secondary.main"},children:L.customerCount}),(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:H()})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,md:3,children:(0,D.jsxs)(g.A,{elevation:2,sx:{p:2,borderRadius:2,height:"100%"},children:[(0,D.jsx)(a.A,{variant:"subtitle2",color:"text.secondary",children:"Service Bookings"}),(0,D.jsx)(a.A,{variant:"h4",sx:{mt:1,color:"success.main"},children:(null===N||void 0===N?void 0:N.totalBookings)||(null===L||void 0===L?void 0:L.reservationCount)||(null===L||void 0===L?void 0:L.serviceData.reduce((e,t)=>e+t.count,0))}),(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:H()})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,md:3,children:(0,D.jsxs)(g.A,{elevation:2,sx:{p:2,borderRadius:2,height:"100%"},children:[(0,D.jsx)(a.A,{variant:"subtitle2",color:"text.secondary",children:"Add-On Revenue"}),(0,D.jsx)(a.A,{variant:"h4",sx:{mt:1,color:"warning.main"},children:(0,z.vv)(L.addOnRevenue)}),(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:H()})]})})]})}),(0,D.jsxs)(g.A,{elevation:3,sx:{borderRadius:2},children:[(0,D.jsx)(s.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,D.jsxs)(v.A,{value:K,onChange:(e,t)=>{I(t)},"aria-label":"analytics tabs",children:[(0,D.jsx)(A.A,{label:"Services",id:"analytics-tab-0","aria-controls":"analytics-tabpanel-0"}),(0,D.jsx)(A.A,{label:"Add-Ons",id:"analytics-tab-1","aria-controls":"analytics-tabpanel-1"})]})}),(0,D.jsx)(E,{value:K,index:0,children:N&&(0,D.jsxs)(j.Ay,{container:!0,spacing:3,children:[(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsx)(j.Ay,{container:!0,spacing:2,children:N.services.sort((e,t)=>t.revenue-e.revenue).slice(0,4).map((e,t)=>(0,D.jsx)(j.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,D.jsxs)(g.A,{elevation:1,sx:{p:2,borderLeft:"4px solid ".concat($[t%$.length]),height:"100%"},children:[(0,D.jsx)(a.A,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:e.name.length>25?e.name.substring(0,23)+"...":e.name}),(0,D.jsx)(a.A,{variant:"h5",sx:{fontWeight:600,mb:.5},children:(0,z.vv)(e.revenue)}),(0,D.jsxs)(a.A,{variant:"body2",color:"text.secondary",children:[e.count," bookings \u2022 ",(0,z.vv)(e.count>0?e.revenue/e.count:0)," avg"]})]})},e.id))})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,lg:8,children:(0,D.jsxs)(u.A,{children:[(0,D.jsx)(y.A,{title:"Top 10 Services by Revenue",titleTypographyProps:{variant:"h6"}}),(0,D.jsx)(m.A,{children:(0,D.jsx)(s.A,{sx:{height:400},children:(0,D.jsx)(B.u,{width:"100%",height:"100%",children:(0,D.jsxs)(W.E,{data:N.services.sort((e,t)=>t.revenue-e.revenue).slice(0,10),layout:"vertical",margin:{top:5,right:30,left:150,bottom:5},children:[(0,D.jsx)(w.d,{strokeDasharray:"3 3"}),(0,D.jsx)(C.W,{type:"number",tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,D.jsx)(O.h,{type:"category",dataKey:"name",width:140,tick:{fontSize:12},tickFormatter:e=>e.length>20?e.substring(0,18)+"...":e}),(0,D.jsx)(T.m,{formatter:e=>[(0,z.vv)(Number(e)),"Revenue"],labelFormatter:e=>"".concat(e)}),(0,D.jsx)(R.y,{dataKey:"revenue",fill:e.palette.primary.main,radius:[0,4,4,0]})]})})})})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,lg:4,children:(0,D.jsxs)(u.A,{sx:{height:"100%"},children:[(0,D.jsx)(y.A,{title:"Service Overview",titleTypographyProps:{variant:"h6"}}),(0,D.jsx)(m.A,{children:(0,D.jsxs)(s.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,D.jsxs)(s.A,{children:[(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"Total Services"}),(0,D.jsx)(a.A,{variant:"h4",sx:{fontWeight:600},children:N.services.length})]}),(0,D.jsxs)(s.A,{children:[(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"Total Revenue"}),(0,D.jsx)(a.A,{variant:"h4",sx:{fontWeight:600,color:"primary.main"},children:(0,z.vv)(N.totalRevenue)})]}),(0,D.jsxs)(s.A,{children:[(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"Total Bookings"}),(0,D.jsx)(a.A,{variant:"h4",sx:{fontWeight:600},children:N.services.reduce((e,t)=>e+t.count,0)})]}),(0,D.jsxs)(s.A,{children:[(0,D.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"Average per Booking"}),(0,D.jsx)(a.A,{variant:"h4",sx:{fontWeight:600},children:(0,z.vv)(N.services.reduce((e,t)=>e+t.count,0)>0?N.totalRevenue/N.services.reduce((e,t)=>e+t.count,0):0)})]})]})})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsxs)(u.A,{children:[(0,D.jsx)(y.A,{title:"Service Performance"}),(0,D.jsx)(m.A,{children:(0,D.jsx)(s.A,{sx:{overflowX:"auto"},children:(0,D.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Service"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Bookings"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Revenue"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Avg. Revenue"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"% of Total"})]})}),(0,D.jsxs)("tbody",{children:[N.services.map(e=>(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.name}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:e.count}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:(0,z.vv)(e.revenue)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:(0,z.vv)(e.count>0?e.revenue/e.count:0)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:N.totalRevenue>0?"".concat((e.revenue/N.totalRevenue*100).toFixed(1),"%"):"0%"})]},e.id)),(0,D.jsxs)("tr",{style:{fontWeight:"bold"},children:[(0,D.jsx)("td",{style:{padding:"8px",borderTop:"2px solid #ddd"},children:"Total"}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:N.services.reduce((e,t)=>e+t.count,0)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:(0,z.vv)(N.totalRevenue)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"}}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:"100%"})]})]})]})})})]})})]})}),(0,D.jsx)(E,{value:K,index:1,children:Y&&(0,D.jsxs)(j.Ay,{container:!0,spacing:3,children:[(0,D.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,D.jsxs)(u.A,{children:[(0,D.jsx)(y.A,{title:"Add-On Revenue Breakdown",titleTypographyProps:{variant:"h6",fontSize:"1rem"},sx:{pb:1}}),(0,D.jsx)(m.A,{sx:{pt:1},children:(0,D.jsx)(s.A,{sx:{height:{xs:250,sm:300}},children:(0,D.jsx)(B.u,{width:"100%",height:"100%",children:(0,D.jsxs)(W.E,{data:Y.addOns,margin:{top:10,right:10,left:0,bottom:80},children:[(0,D.jsx)(w.d,{strokeDasharray:"3 3"}),(0,D.jsx)(C.W,{dataKey:"name",angle:-45,textAnchor:"end",height:70,interval:0,tick:{fontSize:9},tickFormatter:e=>e.length>15?e.substring(0,13)+"...":e}),(0,D.jsx)(O.h,{tickFormatter:e=>(0,z.vv)(e),tick:{fontSize:10},width:60}),(0,D.jsx)(T.m,{formatter:e=>(0,z.vv)(Number(e)),labelFormatter:e=>"".concat(e)}),(0,D.jsx)(R.y,{dataKey:"revenue",fill:e.palette.secondary.main})]})})})})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,D.jsxs)(u.A,{children:[(0,D.jsx)(y.A,{title:"Add-On Usage",titleTypographyProps:{variant:"h6",fontSize:"1rem"},sx:{pb:1}}),(0,D.jsx)(m.A,{sx:{pt:1},children:(0,D.jsx)(s.A,{sx:{height:{xs:250,sm:300}},children:(0,D.jsx)(B.u,{width:"100%",height:"100%",children:(0,D.jsxs)(F.r,{children:[(0,D.jsx)(k.F,{data:Y.addOns,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{percent:t}=e;return t&&t>.05?"".concat((100*t).toFixed(0),"%"):""},outerRadius:window.innerWidth<600?60:80,fill:"#8884d8",dataKey:"count",children:Y.addOns.map((e,t)=>(0,D.jsx)(S.f,{fill:$[t%$.length]},"cell-".concat(t)))}),(0,D.jsx)(T.m,{formatter:e=>["".concat(e," usages"),"Count"]}),(0,D.jsx)(f.s,{layout:"horizontal",verticalAlign:"bottom",align:"center",wrapperStyle:{fontSize:"11px",paddingTop:"10px"},iconSize:8,formatter:e=>e.length>20?e.substring(0,18)+"...":e})]})})})})]})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsxs)(u.A,{children:[(0,D.jsx)(y.A,{title:"Add-On Performance"}),(0,D.jsx)(m.A,{children:(0,D.jsx)(s.A,{sx:{overflowX:"auto"},children:(0,D.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Add-On"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Sales"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Revenue"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"Avg. Price"}),(0,D.jsx)("th",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:"% of Total"})]})}),(0,D.jsxs)("tbody",{children:[Y.addOns.map(e=>(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.name}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:e.count}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:(0,z.vv)(e.revenue)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:(0,z.vv)(e.count>0?e.revenue/e.count:0)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderBottom:"1px solid #ddd"},children:Y.totalRevenue>0?"".concat((e.revenue/Y.totalRevenue*100).toFixed(1),"%"):"0%"})]},e.id)),(0,D.jsxs)("tr",{style:{fontWeight:"bold"},children:[(0,D.jsx)("td",{style:{padding:"8px",borderTop:"2px solid #ddd"},children:"Total"}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:Y.addOns.reduce((e,t)=>e+t.count,0)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:(0,z.vv)(Y.totalRevenue)}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"}}),(0,D.jsx)("td",{style:{textAlign:"right",padding:"8px",borderTop:"2px solid #ddd"},children:"100%"})]})]})]})})})]})})]})})]})]})}}}]);
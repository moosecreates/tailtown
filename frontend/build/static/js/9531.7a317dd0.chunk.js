"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[9531],{29531:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var n=t(9950),r=t(28429),o=t(42074),a=t(43939),i=t(29714),d=t(78317),l=t(2235),c=t(65429),x=t(10226),m=t(82053),p=t(8145),u=t(2046),h=t(25333),w=t(46639),A=t(36080),j=t(49045),v=t(62375),b=t(62462),f=t(4983),y=t(82932),g=t(44414);const P=i.Ik().shape({password:i.Yj().min(8,"Password must be at least 8 characters").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[^a-zA-Z0-9]/,"Password must contain at least one special character").required("Password is required"),confirmPassword:i.Yj().oneOf([i.KR("password")],"Passwords must match").required("Please confirm your password")}),k=()=>{const e=(0,r.Zp)(),[s]=(0,o.ok)(),t=s.get("token"),[i,k]=(0,n.useState)(!1),[S,R]=(0,n.useState)(!1),[C,I]=(0,n.useState)(null),[q,N]=(0,n.useState)(null);if(!t)return(0,g.jsx)(d.A,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default",p:2},children:(0,g.jsxs)(l.A,{elevation:3,sx:{width:"100%",maxWidth:450,p:4},children:[(0,g.jsx)(c.A,{severity:"error",sx:{mb:3},children:"Invalid or missing reset token. Please request a new password reset link."}),(0,g.jsx)(x.A,{component:o.N_,to:"/forgot-password",variant:"contained",fullWidth:!0,children:"Request New Reset Link"})]})});const W=()=>{k(!i)},z=()=>{R(!S)};return(0,g.jsx)(d.A,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default",p:2},children:(0,g.jsxs)(l.A,{elevation:3,sx:{width:"100%",maxWidth:450,p:4},children:[(0,g.jsxs)(d.A,{sx:{textAlign:"center",mb:3},children:[C?(0,g.jsx)(f.A,{sx:{fontSize:48,color:"success.main",mb:2}}):(0,g.jsx)(j.A,{sx:{fontSize:48,color:"primary.main",mb:2}}),(0,g.jsx)(m.A,{variant:"h5",component:"h1",gutterBottom:!0,children:C?"Password Reset!":"Reset Your Password"}),!C&&(0,g.jsx)(m.A,{variant:"body2",color:"text.secondary",children:"Please enter your new password below."})]}),C&&(0,g.jsxs)(c.A,{severity:"success",sx:{mb:3},children:[C,(0,g.jsx)(m.A,{variant:"body2",sx:{mt:1},children:"Redirecting to login page..."})]}),q&&(0,g.jsx)(c.A,{severity:"error",sx:{mb:3},children:q}),!C&&(0,g.jsx)(a.l1,{initialValues:{password:"",confirmPassword:""},validationSchema:P,onSubmit:async(s,n)=>{let{setSubmitting:r}=n;try{N(null),I(null),await y.Ay.post("/staff/reset-password",{token:t,password:s.password}),I("Your password has been reset successfully!"),setTimeout(()=>{e("/login")},3e3)}catch(i){var o,a;const e=(null===(o=i.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message)||"Failed to reset password. The link may have expired.";N(e)}finally{r(!1)}},children:e=>{let{errors:s,touched:t,isSubmitting:n}=e;return(0,g.jsxs)(a.lV,{children:[(0,g.jsx)(a.D0,{as:p.A,name:"password",label:"New Password",type:i?"text":"password",fullWidth:!0,margin:"normal",variant:"outlined",error:t.password&&Boolean(s.password),helperText:t.password&&s.password,disabled:n,autoFocus:!0,InputProps:{endAdornment:(0,g.jsx)(u.A,{position:"end",children:(0,g.jsx)(h.A,{onClick:W,edge:"end",children:i?(0,g.jsx)(b.A,{}):(0,g.jsx)(v.A,{})})})}}),(0,g.jsx)(a.D0,{as:p.A,name:"confirmPassword",label:"Confirm New Password",type:S?"text":"password",fullWidth:!0,margin:"normal",variant:"outlined",error:t.confirmPassword&&Boolean(s.confirmPassword),helperText:t.confirmPassword&&s.confirmPassword,disabled:n,InputProps:{endAdornment:(0,g.jsx)(u.A,{position:"end",children:(0,g.jsx)(h.A,{onClick:z,edge:"end",children:S?(0,g.jsx)(b.A,{}):(0,g.jsx)(v.A,{})})})}}),(0,g.jsxs)(d.A,{sx:{mt:2,mb:2},children:[(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"Password must contain:"}),(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"\u2022 At least 8 characters"}),(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"\u2022 One uppercase letter"}),(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"\u2022 One lowercase letter"}),(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"\u2022 One number"}),(0,g.jsx)(m.A,{variant:"caption",color:"text.secondary",component:"div",children:"\u2022 One special character"})]}),(0,g.jsx)(x.A,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:n,sx:{mt:3,mb:2,py:1.2},children:n?(0,g.jsx)(w.A,{size:24}):"Reset Password"})]})}}),q&&(0,g.jsxs)(d.A,{sx:{textAlign:"center",mt:2},children:[(0,g.jsx)(m.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Link expired or invalid?"}),(0,g.jsx)(A.A,{component:o.N_,to:"/forgot-password",variant:"body2",children:"Request a new reset link"})]}),!C&&!q&&(0,g.jsx)(d.A,{sx:{textAlign:"center",mt:2},children:(0,g.jsx)(A.A,{component:o.N_,to:"/login",variant:"body2",children:"Back to Sign In"})})]})})}}}]);
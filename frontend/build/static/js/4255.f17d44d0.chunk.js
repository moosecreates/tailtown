"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[4255],{54255:(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var n=s(89379),r=s(9950),i=s(62999),a=s(78317),o=s(82053),c=s(10226),l=s(8145),d=s(2046),p=s(25979),x=s(19647),h=s(70006),u=s(23266),A=s(65429),j=s(82917),g=s(1320),y=s(2235),m=s(15769),w=s(69780),f=s(9213),v=s(21671),C=s(34075),b=s(6258),P=s(98785),k=s(49715),E=s(28429),S=s(35286),D=s(82508),N=s(83274),I=s(25277),R=s(11227),z=s(99905),B=s(95699),W=s(88225),T=s(44414);const U=e=>{let{pet:t,showDetails:s=!1}=e;const n=(0,W.g2)(t.type||"DOG"),r=(0,W.Rq)(t.vaccinationStatus,t.vaccineExpirations);let i=0,a=0,o=0;n.forEach(e=>{const t=r[e];t?"EXPIRED"===t.status?i++:"CURRENT"===t.status?o++:a++:a++});return(0,T.jsx)(N.A,{title:s?(()=>{const e=[];return n.forEach(t=>{const s=r[t],n=t.charAt(0).toUpperCase()+t.slice(1);if(s){if("EXPIRED"===s.status){const t=s.expiration?new Date(s.expiration).toLocaleDateString():"Unknown";e.push("".concat(n,": Expired (").concat(t,")"))}else if("CURRENT"===s.status){const t=s.expiration?new Date(s.expiration).toLocaleDateString():"Unknown";e.push("".concat(n,": Current (expires ").concat(t,")"))}}else e.push("".concat(n,": Missing"))}),e.join("\n")})():(()=>{const e=[];return i>0&&e.push("".concat(i," expired")),a>0&&e.push("".concat(a," due")),o>0&&e.push("".concat(o," current")),0===e.length?"All required vaccines are current":"Vaccine status: ".concat(e.join(", "))})(),children:(0,T.jsx)(I.A,{icon:0===i+a?(0,T.jsx)(R.A,{}):i>0?(0,T.jsx)(z.A,{}):(0,T.jsx)(B.A,{}),label:(()=>{const e=i+a;return 0===e?"Current":1===e?"1 Due":"".concat(e," Due")})(),size:"small",color:0===i+a?"success":i>0?"error":"warning",variant:"outlined",sx:{fontSize:"0.7rem",height:"20px"}})})};var V=s(41397);const q=()=>{const e=(0,E.Zp)(),[t,s]=(0,r.useState)([]),[N,I]=(0,r.useState)(!0),[R,z]=(0,r.useState)(null),[B,W]=(0,r.useState)({open:!1,message:"",severity:"success"}),[q,G]=(0,r.useState)(0),[L,M]=(0,r.useState)(0),[O,X]=(0,r.useState)(""),[_,F]=(0,r.useState)(50),[H,Z]=(0,r.useState)(!0),J=(0,r.useCallback)(async(e,t,n)=>{try{I(!0);const r=await S.B.getAllPets(e+1,n||_,t);s(r.data),M(r.results),z(null)}catch(r){console.error("Error loading pets:",r),z("Failed to load pets"),s([])}finally{I(!1),H&&Z(!1)}},[H,_]),K=(0,r.useMemo)(()=>(0,V.debounce)(e=>{G(0),J(0,e)},500),[J]);(0,r.useEffect)(()=>{J(q,O)},[q,O,_,J]),(0,r.useEffect)(()=>(H||K(O),()=>K.cancel()),[O,H,K]);const Q=t=>{e("/pets/".concat(t))},Y=e=>{F(e),G(0),J(0,O,e)};return(0,T.jsxs)(i.A,{maxWidth:"lg",children:[(0,T.jsxs)(a.A,{sx:{mt:4,mb:4},children:[(0,T.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,T.jsx)(o.A,{variant:"h4",gutterBottom:!0,children:"Pets"}),(0,T.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>e("/pets/new"),children:"Add New Pet"})]}),(0,T.jsxs)(a.A,{sx:{display:"flex",gap:2,mb:3,alignItems:"center"},children:[(0,T.jsx)(l.A,{fullWidth:!0,placeholder:"Search pets by name or breed...",value:O,onChange:e=>X(e.target.value),InputProps:{startAdornment:(0,T.jsx)(d.A,{position:"start",children:(0,T.jsx)(k.A,{})})}}),(0,T.jsxs)(p.A,{size:"small",sx:{minWidth:120},children:[(0,T.jsx)(x.A,{children:"Show"}),(0,T.jsxs)(h.A,{value:_,label:"Show",onChange:e=>Y(Number(e.target.value)),children:[(0,T.jsx)(u.A,{value:25,children:"25"}),(0,T.jsx)(u.A,{value:50,children:"50"}),(0,T.jsx)(u.A,{value:100,children:"100"}),(0,T.jsx)(u.A,{value:200,children:"200"})]})]})]}),R&&(0,T.jsx)(A.A,{severity:"error",sx:{mb:2},children:R}),N&&H?(0,T.jsx)(a.A,{sx:{mb:2},children:[...Array(3)].map((e,t)=>(0,T.jsx)(j.A,{height:53,sx:{mb:1}},t))}):(0,T.jsx)(g.A,{component:y.A,children:(0,T.jsxs)(m.A,{size:"small",children:[(0,T.jsx)(w.A,{children:(0,T.jsxs)(f.A,{children:[(0,T.jsx)(v.A,{sx:{py:1},children:"Name"}),(0,T.jsx)(v.A,{sx:{py:1},children:"Type"}),(0,T.jsx)(v.A,{sx:{py:1},children:"Breed"}),(0,T.jsx)(v.A,{sx:{py:1},children:"Gender"}),(0,T.jsx)(v.A,{sx:{py:1},children:"Weight"}),(0,T.jsx)(v.A,{sx:{py:1},children:"Vaccination"}),(0,T.jsx)(v.A,{sx:{py:1},align:"right",children:"Actions"})]})}),(0,T.jsx)(C.A,{children:0===t.length?(0,T.jsx)(f.A,{children:(0,T.jsx)(v.A,{colSpan:7,align:"center",children:"No pets registered"})}):t.map(t=>(0,T.jsxs)(f.A,{sx:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:(0,T.jsx)(D.A,{petName:"".concat(t.name).concat(t.owner?" (".concat(t.owner.lastName,")"):""),petIcons:t.petIcons,iconNotes:t.iconNotes,petType:t.type,profilePhoto:t.profilePhoto,size:"small",nameVariant:"body2",showPhoto:!1})}),(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:t.type}),(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:t.breed||"N/A"}),(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:t.gender||"N/A"}),(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:t.weight?"".concat(t.weight," lbs"):"N/A"}),(0,T.jsx)(v.A,{onClick:()=>Q(t.id),sx:{cursor:"pointer",py:.5},children:(0,T.jsx)(U,{pet:t,showDetails:!0})}),(0,T.jsx)(v.A,{align:"right",sx:{py:.5},children:(0,T.jsxs)(a.A,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[(0,T.jsx)(c.A,{variant:"outlined",size:"small",onClick:()=>e("/pets/".concat(t.id)),sx:{minWidth:"auto",px:1},children:"Edit"}),(0,T.jsx)(c.A,{variant:"outlined",color:"error",size:"small",onClick:e=>(async(e,t)=>{if(e.stopPropagation(),window.confirm("Are you sure you want to permanently delete this pet? This action cannot be undone."))try{await S.B.deletePet(t);const e=await S.B.getAllPets(q+1,_,O);s(e.data),M(e.results),W({open:!0,message:"Pet permanently deleted",severity:"success"})}catch(n){console.error("Error deleting pet:",n),W({open:!0,message:"Error deleting pet. Please try again.",severity:"error"});const e=await S.B.getAllPets(q+1,_,O);if(null===e||void 0===e||!e.data||!Array.isArray(e.data))throw new Error("Invalid response format");s(e.data),M(e.results)}})(e,t.id),sx:{minWidth:"auto",px:1},children:"Delete"})]})})]},t.id))})]})}),!N&&!R&&(0,T.jsx)(b.A,{component:"div",count:L,page:q,onPageChange:(e,t)=>G(t),rowsPerPage:_,rowsPerPageOptions:[25,50,100,200],onRowsPerPageChange:e=>{const t=parseInt(e.target.value,10);Y(t)}})]}),(0,T.jsx)(P.A,{open:B.open,autoHideDuration:6e3,onClose:()=>W(e=>(0,n.A)((0,n.A)({},e),{},{open:!1})),children:(0,T.jsx)(A.A,{onClose:()=>W(e=>(0,n.A)((0,n.A)({},e),{},{open:!1})),severity:B.severity,sx:{width:"100%"},children:B.message})})]})}}}]);
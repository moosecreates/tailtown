"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[7883],{27883:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var a=o(89379),s=o(9950),i=o(78317),n=o(46639),l=o(62999),r=o(82053),c=o(65429),d=o(48089),u=o(45180),g=o(74745),h=o(50704),m=o(10226),x=o(25979),p=o(19647),A=o(70006),f=o(23266),y=o(42647),b=o(20760),j=o(91367),v=o(99107),w=o(44414);const T=()=>{const{user:e}=(0,j.As)(),[t,o]=(0,s.useState)({}),[T,z]=(0,s.useState)(!0),[S,C]=(0,s.useState)(!1),[k,I]=(0,s.useState)(""),[L,U]=(0,s.useState)(""),[B,E]=(0,s.useState)(null),[F,P]=(0,s.useState)("America/Denver"),[R,D]=(0,s.useState)(!1),H=window.location.origin;(0,s.useEffect)(()=>{M()},[]);const M=async()=>{try{z(!0);const e=await fetch("".concat(H,"/api/business-settings"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(e.ok){const t=await e.json();o(t),t.logoUrl&&E(t.logoUrl)}const t=await v.y.getCurrentTenantTimezone();P(t)}catch(e){console.error("Error loading settings:",e)}finally{z(!1)}};return T?(0,w.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,w.jsx)(n.A,{})}):(0,w.jsxs)(l.A,{maxWidth:"md",sx:{mt:2,mb:4},children:[(0,w.jsx)(r.A,{variant:"h5",gutterBottom:!0,children:"Business Settings"}),(0,w.jsx)(r.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Customize your business appearance and settings"}),k&&(0,w.jsx)(c.A,{severity:"error",onClose:()=>I(""),sx:{mb:2},children:k}),L&&(0,w.jsx)(c.A,{severity:"success",onClose:()=>U(""),sx:{mb:2},children:L}),(0,w.jsxs)(d.A,{children:[(0,w.jsx)(u.A,{title:"Business Logo"}),(0,w.jsx)(g.A,{}),(0,w.jsxs)(h.A,{children:[(0,w.jsx)(r.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Upload your business logo to display in the application header. Recommended size: 200x200px. Max file size: 2MB."}),B&&(0,w.jsxs)(i.A,{sx:{mb:3,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,w.jsx)(r.A,{variant:"subtitle2",sx:{mb:1},children:"Current Logo:"}),(0,w.jsx)(i.A,{sx:{width:200,height:200,border:"2px solid",borderColor:"divider",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",bgcolor:"background.paper"},children:(0,w.jsx)("img",{src:B,alt:"Business Logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,w.jsxs)(m.A,{variant:"contained",component:"label",startIcon:(0,w.jsx)(y.A,{}),disabled:S,children:[S?"Uploading...":B?"Replace Logo":"Upload Logo",(0,w.jsx)("input",{type:"file",hidden:!0,accept:"image/*",onChange:async e=>{var s;const i=null===(s=e.target.files)||void 0===s?void 0:s[0];if(i)if(i.type.startsWith("image/"))if(i.size>2097152)I("Image must be less than 2MB");else{C(!0),I(""),U("");try{const e=new FormData;e.append("logo",i);const s=await fetch("".concat(H,"/api/business-settings/logo"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:e});if(!s.ok)throw new Error("Failed to upload logo");const n=await s.json();o((0,a.A)((0,a.A)({},t),{},{logoUrl:n.logoUrl})),E(n.logoUrl),localStorage.setItem("businessLogo","".concat(H).concat(n.logoUrl)),U("Logo uploaded successfully! Refresh the page to see it in the header.")}catch(n){I(n.message||"Failed to upload logo")}finally{C(!1)}}else I("Please upload an image file")}})]}),B&&(0,w.jsx)(m.A,{variant:"outlined",color:"error",startIcon:(0,w.jsx)(b.A,{}),onClick:async()=>{if(window.confirm("Are you sure you want to remove your logo?")){C(!0),I(""),U("");try{if(!(await fetch("".concat(H,"/api/business-settings/logo"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}})).ok)throw new Error("Failed to delete logo");o((0,a.A)((0,a.A)({},t),{},{logoUrl:void 0})),E(null),localStorage.removeItem("businessLogo"),U("Logo removed successfully! Refresh the page to see the default logo.")}catch(e){I(e.message||"Failed to delete logo")}finally{C(!1)}}},disabled:S,children:"Remove Logo"})]}),!B&&(0,w.jsx)(c.A,{severity:"info",sx:{mt:2},children:"No custom logo uploaded. The default Tailtown logo will be displayed."})]})]}),(0,w.jsxs)(d.A,{sx:{mt:3},children:[(0,w.jsx)(u.A,{title:"Regional Settings"}),(0,w.jsx)(g.A,{}),(0,w.jsxs)(h.A,{children:[(0,w.jsx)(r.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Set your business's local timezone. This affects how dates and times are displayed throughout the application, including dashboard appointments, kennel cards, and reports."}),(0,w.jsxs)(x.A,{fullWidth:!0,children:[(0,w.jsx)(p.A,{children:"Timezone"}),(0,w.jsx)(A.A,{value:F,label:"Timezone",onChange:e=>(async e=>{D(!0),I(""),U("");try{if(!(await fetch("".concat(H,"/api/tenants/me/settings"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify({timezone:e})})).ok)throw new Error("Failed to update timezone");P(e),localStorage.setItem("tenant_timezone",e),U("Timezone updated successfully! Changes will apply immediately.")}catch(t){I(t.message||"Failed to update timezone")}finally{D(!1)}})(e.target.value),disabled:R,children:[{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Phoenix",label:"Arizona (no DST)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"}].map(e=>(0,w.jsx)(f.A,{value:e.value,children:e.label},e.value))})]}),R&&(0,w.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:2},children:[(0,w.jsx)(n.A,{size:20}),(0,w.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"Updating timezone..."})]}),(0,w.jsxs)(c.A,{severity:"info",sx:{mt:2},children:["Current timezone: ",(0,w.jsx)("strong",{children:F})]})]})]})]})}}}]);
"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[404],{40404:(e,n,r)=>{r.r(n),r.d(n,{default:()=>W});var s=r(9950),i=r(62999),t=r(78317),a=r(46639),c=r(65429),o=r(82053),l=r(25277),d=r(10226),x=r(48089),h=r(50704),A=r(60899),u=r(2235),j=r(74745),v=r(36080),y=r(25333),m=r(33738),p=r(86817),g=r(23266),b=r(28429),f=r(69179),C=r(76812),N=r(79196),D=r(49885),E=r(11227),I=r(40379),S=r(37319),w=r(35834),O=r(98692),k=r(8830),R=r(73753),L=r(44414);const W=()=>{const{id:e}=(0,b.g)(),n=(0,b.Zp)(),[r,W]=(0,s.useState)(null),[z,F]=(0,s.useState)(!0),[H,T]=(0,s.useState)(null),[_,M]=(0,s.useState)(null),[P,U]=(0,s.useState)(!1),[q,K]=(0,s.useState)(!1),B=(0,s.useCallback)(async()=>{try{if(!e)return;const n=await f.u.getReservationById(e);W(n),T(null),F(!1)}catch(n){T("Failed to load reservation"),F(!1)}},[e]);if((0,s.useEffect)(()=>{B()},[B]),z)return(0,L.jsx)(i.A,{maxWidth:"lg",children:(0,L.jsx)(t.A,{sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,L.jsx)(a.A,{})})});if(H||!r)return(0,L.jsx)(i.A,{maxWidth:"lg",children:(0,L.jsx)(t.A,{sx:{mt:4},children:(0,L.jsx)(c.A,{severity:"error",children:H||"Reservation not found"})})});const{startDate:G,endDate:Z,status:J,notes:Q,staffNotes:V,customer:X,pet:Y,service:$,createdAt:ee}=r,ne=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})},re=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),se=()=>{if(!G||!Z)return"N/A";const e=new Date(G),n=new Date(Z),r=Math.abs(n.getTime()-e.getTime()),s=Math.ceil(r/864e5);return"".concat(s," ").concat(1===s?"night":"nights")},ie=e=>{switch(e){case"CONFIRMED":case"COMPLETED":return"success";case"PENDING":return"warning";case"CHECKED_IN":return"info";case"CHECKED_OUT":return"secondary";case"CANCELLED":case"NO_SHOW":return"error";default:return"default"}},te=()=>{M(null)};return(0,L.jsxs)(i.A,{maxWidth:"lg",children:[(0,L.jsxs)(t.A,{sx:{mt:4,mb:4},children:[H&&(0,L.jsx)(c.A,{severity:"error",sx:{mb:2},children:H}),(0,L.jsxs)(t.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"h4",gutterBottom:!0,children:"Reservation Details"}),(0,L.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:["Order #",r.orderNumber||"Not assigned"]})]}),(0,L.jsxs)(t.A,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,L.jsx)(l.A,{label:r.status,color:ie(r.status),sx:{cursor:"pointer","&:hover":{opacity:.8}},onClick:e=>{M(e.currentTarget)}}),(0,L.jsx)(d.A,{variant:"contained",startIcon:(0,L.jsx)(I.A,{}),onClick:()=>{n("/reservations/".concat(e,"/edit"))},children:"Edit"})]})]}),(0,L.jsx)(x.A,{sx:{mb:3,bgcolor:"primary.light",color:"primary.contrastText"},children:(0,L.jsx)(h.A,{children:(0,L.jsxs)(A.Ay,{container:!0,spacing:3,children:[(0,L.jsx)(A.Ay,{item:!0,xs:12,md:3,children:(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(N.A,{}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"caption",sx:{opacity:.8},children:"Check-In"}),(0,L.jsx)(o.A,{variant:"body2",fontWeight:"bold",children:ne(G)})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,md:3,children:(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(N.A,{}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"caption",sx:{opacity:.8},children:"Check-Out"}),(0,L.jsx)(o.A,{variant:"body2",fontWeight:"bold",children:ne(Z)})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,md:3,children:(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(O.A,{}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"caption",sx:{opacity:.8},children:"Duration"}),(0,L.jsx)(o.A,{variant:"body2",fontWeight:"bold",children:se()})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,md:3,children:(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(O.A,{}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"caption",sx:{opacity:.8},children:"Suite"}),(0,L.jsx)(o.A,{variant:"body2",fontWeight:"bold",children:(()=>{const e=r.resource;if(!e)return"Not assigned";const n=e.suiteNumber||e.attributes&&e.attributes.suiteNumber;return n?"#".concat(n):e.name})()})]})]})})]})})}),(0,L.jsxs)(A.Ay,{container:!0,spacing:3,children:[(0,L.jsx)(A.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(u.A,{sx:{p:3,height:"100%"},children:[(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,L.jsx)(R.A,{color:"primary"}),(0,L.jsx)(o.A,{variant:"h6",children:"Pet & Customer"})]}),(0,L.jsxs)(t.A,{sx:{mb:3},children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Pet"}),(0,L.jsx)(o.A,{variant:"h6",children:(null===Y||void 0===Y?void 0:Y.name)||"N/A"}),(0,L.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[(null===Y||void 0===Y?void 0:Y.type)||"N/A"," \u2022 ",(null===Y||void 0===Y?void 0:Y.breed)||"N/A"]})]}),(0,L.jsx)(j.A,{sx:{my:2}}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Owner"}),(0,L.jsxs)(o.A,{variant:"h6",children:[(null===X||void 0===X?void 0:X.firstName)||"N/A"," ",(null===X||void 0===X?void 0:X.lastName)||""]}),(0,L.jsxs)(t.A,{sx:{mt:1},children:[(0,L.jsxs)(o.A,{variant:"body2",sx:{display:"flex",alignItems:"center",gap:.5},children:["\ud83d\udce7 ",(null===X||void 0===X?void 0:X.email)||"N/A"]}),(0,L.jsxs)(o.A,{variant:"body2",sx:{display:"flex",alignItems:"center",gap:.5},children:["\ud83d\udcf1 ",(null===X||void 0===X?void 0:X.phone)||"N/A"]})]})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(u.A,{sx:{p:3,height:"100%"},children:[(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,L.jsx)(O.A,{color:"primary"}),(0,L.jsx)(o.A,{variant:"h6",children:"Service Details"})]}),(0,L.jsxs)(t.A,{sx:{mb:2},children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Service"}),(0,L.jsx)(o.A,{variant:"h6",children:(null===$||void 0===$?void 0:$.name)||"N/A"}),(0,L.jsx)(o.A,{variant:"body2",color:"text.secondary",children:(null===$||void 0===$?void 0:$.description)||""})]}),r.resource&&(0,L.jsxs)(t.A,{sx:{mb:2},children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Assigned Suite"}),(0,L.jsx)(o.A,{variant:"body1",children:(()=>{const e=r.resource,n=e.suiteNumber||e.attributes&&e.attributes.suiteNumber;return n?"Suite #".concat(n," (").concat(e.type,")"):"".concat(e.name," (").concat(e.type,")")})()})]}),(0,L.jsxs)(t.A,{children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Duration"}),(0,L.jsx)(o.A,{variant:"body1",children:se()})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,children:(0,L.jsxs)(u.A,{sx:{p:3},children:[(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,L.jsx)(C.A,{color:"primary"}),(0,L.jsx)(o.A,{variant:"h6",children:"Financial Summary"})]}),(0,L.jsxs)(A.Ay,{container:!0,spacing:2,children:[(0,L.jsx)(A.Ay,{item:!0,xs:12,md:8,children:(0,L.jsxs)(t.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,L.jsxs)(t.A,{sx:{display:"flex",justifyContent:"space-between",py:1},children:[(0,L.jsx)(o.A,{variant:"body1",children:(null===$||void 0===$?void 0:$.name)||"Service"}),(0,L.jsx)(o.A,{variant:"body1",children:re((null===$||void 0===$?void 0:$.price)||0)})]}),r.addOnServices&&r.addOnServices.length>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(j.A,{}),(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Add-On Services"}),r.addOnServices.map((e,n)=>{var r;return(0,L.jsxs)(t.A,{sx:{display:"flex",justifyContent:"space-between",py:.5,pl:2},children:[(0,L.jsxs)(o.A,{variant:"body2",children:[e.name||(null===(r=e.addOn)||void 0===r?void 0:r.name)||"Unnamed Add-on",e.quantity&&e.quantity>1?" (\xd7".concat(e.quantity,")"):""]}),(0,L.jsx)(o.A,{variant:"body2",children:re((e.price||0)*(e.quantity||1))})]},n)})]}),r.discount&&r.discount>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(j.A,{}),(0,L.jsxs)(t.A,{sx:{display:"flex",justifyContent:"space-between",py:1},children:[(0,L.jsx)(o.A,{variant:"body1",color:"error.main",children:"Discount"}),(0,L.jsxs)(o.A,{variant:"body1",color:"error.main",children:["-",re(r.discount)]})]})]}),(0,L.jsx)(j.A,{sx:{borderStyle:"dashed",borderWidth:2}}),(0,L.jsxs)(t.A,{sx:{display:"flex",justifyContent:"space-between",py:1},children:[(0,L.jsx)(o.A,{variant:"h6",children:"Total"}),(0,L.jsx)(o.A,{variant:"h6",color:"primary.main",children:re((()=>{var e;return((null===$||void 0===$?void 0:$.price)||0)+((null===(e=r.addOnServices)||void 0===e?void 0:e.reduce((e,n)=>e+(n.price||0)*(n.quantity||1),0))||0)-(r.discount||0)})())})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,md:4,children:(0,L.jsxs)(t.A,{sx:{bgcolor:"grey.50",p:2,borderRadius:1,height:"100%"},children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Invoice"}),r.invoice?(0,L.jsxs)(t.A,{children:[(0,L.jsx)(v.A,{href:"/invoices/".concat(r.invoice.id),sx:{textDecoration:"none"},children:(0,L.jsxs)(o.A,{variant:"h6",color:"primary",children:["#",r.invoice.invoiceNumber]})}),(0,L.jsx)(l.A,{label:r.invoice.status||"Pending",size:"small",color:"PAID"===r.invoice.status?"success":"warning",sx:{mt:1}})]}):(0,L.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"No invoice generated"})]})})]})]})}),(0,L.jsx)(A.Ay,{item:!0,xs:12,children:(0,L.jsxs)(u.A,{sx:{overflow:"hidden"},children:[(0,L.jsxs)(t.A,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:()=>K(!q),children:[(0,L.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(k.A,{color:"primary"}),(0,L.jsx)(o.A,{variant:"h6",children:"Notes"}),(Q||V)&&(0,L.jsx)(l.A,{label:"Has notes",size:"small",color:"info"})]}),(0,L.jsx)(y.A,{size:"small",sx:{transform:q?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"},children:(0,L.jsx)(w.A,{})})]}),(0,L.jsxs)(m.A,{in:q,children:[(0,L.jsx)(j.A,{}),(0,L.jsx)(t.A,{sx:{p:3},children:(0,L.jsxs)(A.Ay,{container:!0,spacing:3,children:[(0,L.jsxs)(A.Ay,{item:!0,xs:12,md:6,children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Customer Notes"}),(0,L.jsx)(o.A,{variant:"body2",sx:{mt:1},children:Q||"No notes provided"})]}),(0,L.jsxs)(A.Ay,{item:!0,xs:12,md:6,children:[(0,L.jsx)(o.A,{variant:"overline",color:"text.secondary",children:"Staff Notes"}),(0,L.jsx)(o.A,{variant:"body2",sx:{mt:1},children:V||"No staff notes"})]})]})})]})]})})]}),(0,L.jsxs)(t.A,{sx:{mt:3,display:"flex",gap:2,flexWrap:"wrap"},children:["CONFIRMED"===r.status&&(0,L.jsx)(d.A,{variant:"contained",color:"info",startIcon:(0,L.jsx)(E.A,{}),onClick:()=>{e&&n("/check-in/".concat(e))},size:"large",children:"Check In"}),"CHECKED_IN"===r.status&&(0,L.jsx)(d.A,{variant:"contained",color:"secondary",startIcon:(0,L.jsx)(S.A,{}),onClick:()=>{e&&n("/checkout/".concat(e))},size:"large",children:"Check Out"}),(0,L.jsx)(d.A,{variant:"outlined",color:"error",startIcon:(0,L.jsx)(D.A,{}),onClick:async()=>{try{if(!e)return;await f.u.updateReservation(e,{status:"CANCELLED"}),await B()}catch(H){console.error("Error cancelling reservation:",H),T("Failed to cancel reservation")}},disabled:"CANCELLED"===r.status,children:"Cancel Reservation"}),(0,L.jsx)(d.A,{variant:"outlined",onClick:()=>{n("/reservations")},children:"Back to Reservations"})]}),(0,L.jsx)(t.A,{sx:{mt:3,p:2,bgcolor:"grey.50",borderRadius:1},children:(0,L.jsxs)(o.A,{variant:"caption",color:"text.secondary",children:["Reservation created on ",(e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})(ee)]})})]}),(0,L.jsx)(p.A,{anchorEl:_,open:Boolean(_),onClose:te,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:["PENDING","CONFIRMED","CHECKED_IN","CHECKED_OUT","COMPLETED","CANCELLED","NO_SHOW"].map(n=>(0,L.jsx)(g.A,{onClick:()=>(async n=>{if(e)try{U(!0),await f.u.updateReservation(e,{status:n}),await B(),te()}catch(r){console.error("Error updating reservation status:",r),T("Failed to update reservation status")}finally{U(!1)}})(n),disabled:P||r&&r.status===n,sx:{fontSize:"0.875rem",py:.75,minHeight:"auto",color:r&&r.status===n?"text.disabled":"inherit"},children:(0,L.jsx)(l.A,{size:"small",label:n,color:ie(n),sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem"},minWidth:"80px"}})},n))})]})}}}]);
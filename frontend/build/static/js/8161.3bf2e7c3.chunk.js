"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[8161],{48161:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I});var s=r(89379),a=r(9950),n=r(62999),i=r(78317),o=r(46639),l=r(82053),c=r(10226),d=r(65429),x=r(2235),u=r(25277),h=r(25333),p=r(96583),m=r(40033),v=r(28170),A=r(86817),y=r(23266),g=r(53256),j=r(82508),f=r(396),b=r(81831),C=r(95722),S=r(67991),E=r(92685),w=r(69179),N=r(44414);const I=()=>{const[e,t]=(0,a.useState)([]),[r,I]=(0,a.useState)(!1),[k,z]=(0,a.useState)(""),[D,O]=(0,a.useState)(!1),[P,T]=(0,a.useState)(1),[_,M]=(0,a.useState)(1),[R,W]=(0,a.useState)(null),[F,H]=(0,a.useState)(null),[L,U]=(0,a.useState)(!1),[K,G]=(0,a.useState)(()=>new Date),B=(0,a.useCallback)(e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)},[]),V=(0,a.useCallback)(async()=>{try{I(!0),z("");B(K);const r=await w.u.getAllReservations(P,10,"startDate","asc",void 0,B(K));let s=[],a=1;if(r&&"object"===typeof r){const t=r;var e;if("success"===t.status)Array.isArray(t.data)?s=t.data:t.data&&Array.isArray(t.data.data)?s=t.data.data:t.data&&Array.isArray(t.data.reservations)&&(s=t.data.reservations),a=t.totalPages||(null===(e=t.pagination)||void 0===e?void 0:e.totalPages)||1;else Array.isArray(t)&&(s=t)}Array.isArray(s)||(console.error("Invalid reservations response format:",r),s=[]),t(s),M(a)}catch(r){z("Failed to load reservations"),console.error("Error loading reservations:",r)}finally{I(!1)}},[P,K]);(0,a.useEffect)(()=>{V()},[V]);const Y=(0,a.useCallback)(e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),[]),$=(0,a.useCallback)(e=>{switch(e){case"CONFIRMED":case"COMPLETED":return"success";case"PENDING":return"warning";case"CHECKED_IN":return"info";case"CHECKED_OUT":return"secondary";case"CANCELLED":case"NO_SHOW":return"error";default:return"default"}},[]),q=()=>{W(null)};return r&&!e.length?(0,N.jsx)(n.A,{maxWidth:"lg",children:(0,N.jsx)(i.A,{sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,N.jsx)(o.A,{})})}):(0,N.jsxs)(n.A,{maxWidth:"lg",children:[(0,N.jsxs)(i.A,{sx:{mb:4},children:[(0,N.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,N.jsx)(l.A,{variant:"h5",children:"Reservations"}),(0,N.jsxs)(i.A,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,N.jsx)(b.$,{dateAdapter:f.h,children:(0,N.jsx)(C.l,{label:"Filter by Date",value:K,onChange:e=>{e&&G(e)},slotProps:{textField:{size:"small",sx:{minWidth:"150px"}}}})}),(0,N.jsx)(c.A,{variant:"contained",color:"primary",startIcon:(0,N.jsx)(g.A,{}),onClick:()=>O(!0),children:"New Reservation"})]})]}),k&&(0,N.jsx)(d.A,{severity:"error",sx:{mb:3},children:k}),(0,N.jsx)(x.A,{elevation:3,children:(0,N.jsx)(i.A,{sx:{p:1.5},children:0===e.length?(0,N.jsx)(l.A,{variant:"body1",children:"No reservations found"}):(0,N.jsx)(i.A,{sx:{display:"grid",gap:1},children:e.map(e=>{var t,r,s,a,n,o,c,d,p,m,v;return(0,N.jsx)(x.A,{elevation:1,onClick:()=>window.location.href="/reservations/".concat(e.id),sx:{p:1.5,"&:hover":{backgroundColor:"action.hover",transition:"background-color 0.2s",cursor:"pointer"}},children:(0,N.jsxs)(i.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"2fr 2fr 2.5fr 100px"},gap:2,alignItems:"center"},children:[(0,N.jsxs)(i.A,{children:[(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Pet:"}),(0,N.jsx)(j.A,{petName:(null===(t=e.pet)||void 0===t?void 0:t.name)||"Unknown",petIcons:null===(r=e.pet)||void 0===r?void 0:r.petIcons,iconNotes:null===(s=e.pet)||void 0===s?void 0:s.iconNotes,petType:null===(a=e.pet)||void 0===a?void 0:a.type,profilePhoto:null===(n=e.pet)||void 0===n?void 0:n.profilePhoto,size:"small",nameVariant:"body2",showPhoto:!0}),(null===(o=e.pet)||void 0===o?void 0:o.type)&&(0,N.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:["(",null===(c=e.pet)||void 0===c?void 0:c.type,")"]})]}),(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Owner:"}),(0,N.jsxs)(l.A,{variant:"body2",children:[(null===(d=e.customer)||void 0===d?void 0:d.firstName)||""," ",(null===(p=e.customer)||void 0===p?void 0:p.lastName)||""]})]})]}),(0,N.jsxs)(i.A,{children:[(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Service:"}),(0,N.jsx)(l.A,{variant:"body2",children:(null===(m=e.service)||void 0===m?void 0:m.name)||"Unknown"})]}),(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Status:"}),(0,N.jsx)(u.A,{size:"small",label:e.status,color:$(e.status),onClick:t=>{t.stopPropagation(),((e,t)=>{W(e.currentTarget),H(t)})(t,e)},sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem"},cursor:"pointer","&:hover":{opacity:.8}}})]}),(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Kennel:"}),e.resource?(0,N.jsx)(u.A,{size:"small",label:null!==(v=e.resource.attributes)&&void 0!==v&&v.suiteNumber?"#".concat(e.resource.attributes.suiteNumber," - ").concat(e.resource.name||"Suite"):e.resource.name||"#".concat(e.resource.id.substring(0,6)),color:"primary",variant:"outlined",sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem"}}}):(0,N.jsx)(l.A,{variant:"body2",color:"text.secondary",children:e.suiteType?"Auto-assigned (".concat(e.suiteType.replace("_SUITE","").replace("_"," "),")"):"Not assigned"})]})]}),(0,N.jsxs)(i.A,{children:[(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Check-In:"}),(0,N.jsx)(l.A,{variant:"body2",children:Y(e.startDate)})]}),(0,N.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.5},children:[(0,N.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Check-Out:"}),(0,N.jsx)(l.A,{variant:"body2",children:Y(e.endDate)})]})]}),(0,N.jsx)(i.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,N.jsx)(h.A,{color:"primary",size:"small",onClick:t=>{t.stopPropagation(),window.location.href="/reservations/".concat(e.id)},sx:{"&:hover":{backgroundColor:"primary.light",color:"common.white"}},children:(0,N.jsx)(S.A,{fontSize:"small"})})})]})},e.id)})})})})]}),(0,N.jsxs)(p.A,{open:D,onClose:()=>O(!1),maxWidth:"sm",fullWidth:!0,children:[(0,N.jsx)(m.A,{children:"Create New Reservation"}),(0,N.jsx)(v.A,{children:(0,N.jsx)(E.A,{onSubmit:async e=>{try{await w.u.createReservation(e),O(!1),V()}catch(t){throw console.error("Error creating reservation:",t),t}}})})]}),(0,N.jsx)(A.A,{anchorEl:R,open:Boolean(R),onClose:q,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:["PENDING","CONFIRMED","CHECKED_IN","CHECKED_OUT","COMPLETED","CANCELLED","NO_SHOW"].map(e=>(0,N.jsx)(y.A,{onClick:()=>(async e=>{if(F)try{U(!0),await w.u.updateReservation(F.id,{status:e}),t(t=>t.map(t=>t.id===F.id?(0,s.A)((0,s.A)({},t),{},{status:e}):t)),q()}catch(r){console.error("Error updating reservation status:",r),z("Failed to update reservation status")}finally{U(!1)}})(e),disabled:L||F&&F.status===e,sx:{fontSize:"0.875rem",py:.75,minHeight:"auto",color:F&&F.status===e?"text.disabled":"inherit"},children:(0,N.jsx)(u.A,{size:"small",label:e,color:$(e),sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem"},minWidth:"80px"}})},e))})]})}}}]);
"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[9081],{79081:(e,s,t)=>{t.r(s),t.d(s,{default:()=>_});var n=t(89379),i=t(9950),a=t(62999),l=t(78317),r=t(82053),o=t(2235),d=t(60899),c=t(10226),u=t(96583),x=t(40033),h=t(28170),A=t(46639),v=t(81616),p=t(25277),j=t(48089),m=t(50704),g=t(79739),f=t(4804),b=t(83274),y=t(25333),S=t(8145),C=t(2046),E=t(25979),N=t(19647),D=t(70006),w=t(23266),T=t(95722),I=t(81831),R=t(396),L=t(19223),P=t(2212),k=t(6565),U=t(92383),O=t(54060);const M=e=>{var s;if("MAINTENANCE"===(null===(s=e.attributes)||void 0===s?void 0:s.maintenanceStatus))return"MAINTENANCE";if(e.reservations&&e.reservations.length>0){if(e.reservations.some(e=>["PENDING","CONFIRMED","CHECKED_IN"].includes(e.status)))return"OCCUPIED";if(e.reservations.some(e=>"CONFIRMED"===e.status&&new Date(e.startDate)>new Date))return"RESERVED"}return"AVAILABLE"};var F=t(44414),V=function(e){return e.STANDARD="STANDARD_SUITE",e.STANDARD_PLUS="STANDARD_PLUS_SUITE",e.VIP="VIP_SUITE",e}(V||{});V.STANDARD,V.STANDARD_PLUS,V.VIP;const B={AVAILABLE:"#81C784",OCCUPIED:"#FF8A65",MAINTENANCE:"#9E9E9E",RESERVED:"#FFD54F"},W=e=>{let{onSelectSuite:s,reloadTrigger:t,filterDate:a,onFilterDateChange:c,suites:u}=e;const x=i.useRef(null),[h,A]=(0,i.useState)([]),[v,g]=(0,i.useState)(!0),[f,W]=(0,i.useState)(null),[_,z]=(0,i.useState)({suiteType:"all",status:"all",search:"",date:a||new Date});(0,i.useEffect)(()=>{$()},[t]),(0,i.useEffect)(()=>{a&&z(e=>(0,n.A)((0,n.A)({},e),{},{date:a}))},[a]),(0,i.useEffect)(()=>{JSON.stringify(_)!==JSON.stringify(x.current)&&($(),x.current=(0,n.A)({},_))},[_.suiteType,_.status,_.search,_.date]);const $=async()=>{if(_)try{g(!0),W(null);const e=(0,O.$T)(_.date)||(0,O.$T)(new Date),s=await U.c.getSuites("all"!==_.suiteType?_.suiteType:void 0,void 0,void 0,e);if("success"===(null===s||void 0===s?void 0:s.status)&&Array.isArray(null===s||void 0===s?void 0:s.data)){const e=s.data.map(e=>{var s,t,n;let i=null,a=null;if(e.reservations&&e.reservations.length>0){const s=e.reservations[0];s.pet&&(i=s.pet,s.pet.customer&&(a=s.pet.customer)),!a&&s.customer&&(a=s.customer)}const l=M(e),r=e.type||(null===(s=e.attributes)||void 0===s?void 0:s.suiteType)||"STANDARD_SUITE";return{id:e.id,name:e.name,suiteNumber:(null===(t=e.attributes)||void 0===t?void 0:t.suiteNumber)||e.name||"N/A",suiteType:r,status:l,pet:i,owner:a,notes:e.notes||"",lastCleaned:null===(n=e.attributes)||void 0===n?void 0:n.lastCleaned}}).sort((e,s)=>{const t=String(e.suiteNumber),n=String(s.suiteNumber);return t.localeCompare(n,void 0,{numeric:!0,sensitivity:"base"})});let t=e;"all"!==_.status&&(t=e.filter(e=>e.status===_.status)),A(t),W(null)}else W("Could not load suites: Unexpected response format."),A([]),console.error("Suites API response:",s)}catch(f){let t="Could not load suites.";var e;if(null!==f&&void 0!==f&&f.response)t+=" Server responded with status ".concat(f.response.status,": ").concat((null===(e=f.response.data)||void 0===e?void 0:e.message)||f.response.statusText);else null!==f&&void 0!==f&&f.message&&(t+=" ".concat(f.message));W(t),A([]),console.error("Error loading suites:",f)}finally{g(!1)}},G=h.filter(e=>{var s,t,n,i,a,l,r,o;if(!_.search)return!0;const d=_.search.toLowerCase();return!!e.name.toLowerCase().includes(d)||(!!String(e.suiteNumber).includes(d)||(!(null===(s=e.pet)||void 0===s||null===(t=s.name)||void 0===t||!t.toLowerCase().includes(d))||(!(null===(n=e.pet)||void 0===n||null===(i=n.type)||void 0===i||!i.toLowerCase().includes(d))||(!(null===(a=e.owner)||void 0===a||null===(l=a.firstName)||void 0===l||!l.toLowerCase().includes(d))||!(null===(r=e.owner)||void 0===r||null===(o=r.lastName)||void 0===o||!o.toLowerCase().includes(d))))))}),K=e=>{e.suiteType;const t=B[e.status]||"#E0E0E0";return(0,F.jsxs)(j.A,{sx:{height:"100%",display:"flex",flexDirection:"column",cursor:"pointer",borderLeft:"8px solid ".concat(t),"&:hover":{boxShadow:3,transform:"translateY(-4px)",transition:"transform 0.2s"}},"data-suite-id":e.id,"data-status":e.status,onClick:()=>{s&&s(e.id,e.status)},children:[(0,F.jsxs)(m.A,{sx:{p:1,flexGrow:1},children:[(0,F.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,F.jsx)(r.A,{variant:"h6",component:"div",children:e.suiteNumber}),(0,F.jsx)(p.A,{label:e.suiteType,size:"small",color:e.suiteType===V.VIP?"warning":e.suiteType===V.STANDARD_PLUS?"info":"default"})]}),e.pet?(0,F.jsxs)(l.A,{children:[(0,F.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5,mb:.5},children:[(0,F.jsx)(k.A,{fontSize:"small",color:"primary"}),(0,F.jsxs)(r.A,{variant:"body2",fontWeight:"medium",children:[e.pet.name," (",e.pet.type,")"]})]}),(0,F.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5,ml:1},children:(0,F.jsxs)(r.A,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[(0,F.jsx)("span",{style:{fontWeight:"bold",marginRight:"4px"},children:"Owner:"}),e.owner?"".concat(e.owner.firstName," ").concat(e.owner.lastName):"Unknown"]})})]}):(0,F.jsx)(l.A,{sx:{height:"40px",display:"flex",alignItems:"center"},children:(0,F.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"MAINTENANCE"===e.status?"Under Maintenance":"Available"})})]}),"OCCUPIED"!==e.status&&(0,F.jsx)(l.A,{sx:{display:"flex",justifyContent:"flex-end",p:.5},children:(0,F.jsx)(b.A,{title:"Mark as cleaned",children:(0,F.jsx)(y.A,{size:"small",onClick:s=>{s.stopPropagation(),e.id},children:(0,F.jsx)(P.A,{fontSize:"small"})})})})]},e.id)};return(0,F.jsxs)(l.A,{children:[f&&(0,F.jsx)(l.A,{sx:{mb:2},children:(0,F.jsx)(o.A,{sx:{p:2,bgcolor:"#ffebee",color:"#b71c1c"},children:(0,F.jsx)(r.A,{variant:"body1",children:f})})}),(0,F.jsxs)(l.A,{sx:{mb:3,display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[(0,F.jsx)(S.A,{placeholder:"Search suite, pet, or owner",size:"small",value:_.search,onChange:e=>{z((0,n.A)((0,n.A)({},_),{},{search:e.target.value}))},InputProps:{startAdornment:(0,F.jsx)(C.A,{position:"start",children:(0,F.jsx)(L.A,{})})},sx:{flexGrow:1,minWidth:"200px"}}),(0,F.jsxs)(E.A,{size:"small",sx:{minWidth:"150px"},children:[(0,F.jsx)(N.A,{children:"Suite Type"}),(0,F.jsxs)(D.A,{value:_.suiteType,label:"Suite Type",onChange:e=>{z((0,n.A)((0,n.A)({},_),{},{suiteType:e.target.value}))},children:[(0,F.jsx)(w.A,{value:"all",children:"All Types"}),(0,F.jsx)(w.A,{value:V.STANDARD,children:"Standard"}),(0,F.jsx)(w.A,{value:V.STANDARD_PLUS,children:"Standard Plus"}),(0,F.jsx)(w.A,{value:V.VIP,children:"VIP"})]})]}),(0,F.jsxs)(E.A,{size:"small",sx:{minWidth:"150px"},children:[(0,F.jsx)(N.A,{children:"Status"}),(0,F.jsxs)(D.A,{value:_.status,label:"Status",onChange:e=>{z((0,n.A)((0,n.A)({},_),{},{status:e.target.value}))},children:[(0,F.jsx)(w.A,{value:"all",children:"All Status"}),(0,F.jsx)(w.A,{value:"AVAILABLE",children:"Available"}),(0,F.jsx)(w.A,{value:"OCCUPIED",children:"Occupied"}),(0,F.jsx)(w.A,{value:"MAINTENANCE",children:"Maintenance"}),(0,F.jsx)(w.A,{value:"RESERVED",children:"Reserved"})]})]}),(0,F.jsx)(I.$,{dateAdapter:R.h,children:(0,F.jsx)(T.l,{label:"Filter Date",value:_.date,onChange:e=>{e&&(z((0,n.A)((0,n.A)({},_),{},{date:e})),c&&c(e))},slotProps:{textField:{size:"small",sx:{minWidth:"150px"}}}})})]}),(0,F.jsx)(d.Ay,{container:!0,spacing:2,children:v?(0,F.jsx)(d.Ay,{item:!0,xs:12,children:(0,F.jsx)(r.A,{children:"Loading suites..."})}):0===G.length?(0,F.jsx)(d.Ay,{item:!0,xs:12,children:(0,F.jsx)(r.A,{children:"No suites match your filter criteria."})}):G.map(e=>(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,xl:2,children:K(e)},e.id))}),(0,F.jsxs)(l.A,{sx:{mt:3,display:"flex",gap:2,flexWrap:"wrap"},children:[(0,F.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,F.jsx)(l.A,{sx:{width:16,height:16,backgroundColor:B.AVAILABLE,borderRadius:"50%"}}),(0,F.jsx)(r.A,{variant:"body2",children:"Available"})]}),(0,F.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,F.jsx)(l.A,{sx:{width:16,height:16,backgroundColor:B.OCCUPIED,borderRadius:"50%"}}),(0,F.jsx)(r.A,{variant:"body2",children:"Occupied"})]}),(0,F.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,F.jsx)(l.A,{sx:{width:16,height:16,backgroundColor:B.MAINTENANCE,borderRadius:"50%"}}),(0,F.jsx)(r.A,{variant:"body2",children:"Maintenance"})]}),(0,F.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,F.jsx)(l.A,{sx:{width:16,height:16,backgroundColor:B.RESERVED,borderRadius:"50%"}}),(0,F.jsx)(r.A,{variant:"body2",children:"Reserved"})]}),(0,F.jsx)(r.A,{variant:"caption",sx:{ml:2,alignSelf:"center"},children:"The colored bar on the left of each card indicates its status"})]})]})};t(82932);const _=()=>{var e,s,t,b,y,S,C,E,N,D,w;const[T,I]=(0,i.useState)(null),[R,L]=(0,i.useState)(null),[P,k]=(0,i.useState)(!1),[V,B]=(0,i.useState)(new Date),[_,z]=(0,i.useState)({total:0,occupied:0,available:0,reserved:0,maintenance:0,needsCleaning:0,occupancyRate:0}),[$,G]=(0,i.useState)(null),[K,J]=(0,i.useState)(0),[H,Y]=(0,i.useState)(!1),q=()=>{const e=(0,O.$T)(V);U.c.getSuiteStats(e).then(e=>{"success"===(null===e||void 0===e?void 0:e.status)&&null!==e&&void 0!==e&&e.data&&z(e.data)}).catch(e=>{console.error("Error refreshing suite stats:",e)}),J(e=>e+1),T&&X(T)},Q=(0,i.useCallback)(async()=>{try{k(!0);const e=(0,O.$T)(V),s=await U.c.getSuiteStats(e);"success"===(null===s||void 0===s?void 0:s.status)&&null!==s&&void 0!==s&&s.data&&z(s.data)}catch(s){let t="Could not load suite stats.";var e;if(null!==s&&void 0!==s&&s.response)t+=" Server responded with status ".concat(s.response.status,": ").concat((null===(e=s.response.data)||void 0===e?void 0:e.message)||s.response.statusText);else null!==s&&void 0!==s&&s.message&&(t+=" ".concat(s.message));G(t),console.error("Error loading suite stats:",s)}finally{k(!1)}},[V]);(0,i.useEffect)(()=>{Q()},[Q]);const X=async(e,s)=>{try{k(!0),I(e);const s=(0,O.$T)(V)||(0,O.$T)(new Date),t=await U.c.getResource(e,s);if("success"===(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data){M(t.data);L(t.data)}}catch(t){console.error("Error loading suite details:",t)}finally{k(!1)}};return(0,F.jsxs)(a.A,{maxWidth:"xl",children:[(0,F.jsxs)(l.A,{sx:{p:3},children:[(0,F.jsx)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:(0,F.jsx)(r.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Kennel Management"})}),$&&(0,F.jsx)(l.A,{sx:{mb:2},children:(0,F.jsx)(o.A,{sx:{p:2,bgcolor:"#ffebee",color:"#b71c1c"},children:(0,F.jsx)(r.A,{variant:"body1",children:$})})}),(0,F.jsx)(l.A,{sx:{mb:4},children:(0,F.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(d.Ay,{item:!0,xs:12,md:4,lg:2,children:(0,F.jsxs)(o.A,{sx:{p:2,height:"100%",bgcolor:"primary.light",color:"white"},children:[(0,F.jsx)(r.A,{variant:"h6",children:"Total Suites"}),(0,F.jsx)(r.A,{variant:"h3",children:_.total})]})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,md:4,lg:2.5,children:(0,F.jsxs)(o.A,{sx:{p:2,height:"100%",bgcolor:"#81C784"},children:[(0,F.jsx)(r.A,{variant:"h6",children:"Available"}),(0,F.jsx)(r.A,{variant:"h3",children:_.available})]})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,md:4,lg:2.5,children:(0,F.jsxs)(o.A,{sx:{p:2,height:"100%",bgcolor:"#FF8A65",color:"white"},children:[(0,F.jsx)(r.A,{variant:"h6",children:"Occupied"}),(0,F.jsx)(r.A,{variant:"h3",children:_.occupied})]})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,md:6,lg:2.5,children:(0,F.jsxs)(o.A,{sx:{p:2,height:"100%",bgcolor:"#FFB74D"},children:[(0,F.jsx)(r.A,{variant:"h6",children:"Reserved"}),(0,F.jsx)(r.A,{variant:"h3",children:_.reserved||0})]})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,md:6,lg:2.5,children:(0,F.jsxs)(o.A,{sx:{p:2,height:"100%",bgcolor:"#9E9E9E",color:"white"},children:[(0,F.jsx)(r.A,{variant:"h6",children:"Maintenance"}),(0,F.jsx)(r.A,{variant:"h3",children:_.maintenance})]})})]})}),(0,F.jsxs)(o.A,{sx:{p:3,mb:4},children:[(0,F.jsx)(r.A,{variant:"h5",gutterBottom:!0,children:"Kennel Board"}),(0,F.jsx)(l.A,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:(0,F.jsx)(c.A,{variant:"outlined",startIcon:(0,F.jsx)(f.A,{}),onClick:q,sx:{mr:2},children:"Refresh"})}),(0,F.jsx)(W,{onSelectSuite:X,reloadTrigger:K,filterDate:V,onFilterDateChange:e=>{B(e);const s=(0,O.$T)(e);U.c.getSuiteStats(s).then(e=>{"success"===(null===e||void 0===e?void 0:e.status)&&null!==e&&void 0!==e&&e.data&&z(e.data)}).catch(e=>{console.error("Error refreshing suite stats:",e)}),T&&X(T)}})]})]}),(0,F.jsxs)(u.A,{open:Boolean(T),onClose:()=>I(null),maxWidth:"sm",fullWidth:!0,children:[(0,F.jsx)(x.A,{children:"Suite Details"}),(0,F.jsx)(h.A,{dividers:!0,children:P?(0,F.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,F.jsx)(A.A,{})}):R?(0,F.jsxs)(v.A,{spacing:2,children:[(0,F.jsxs)(l.A,{children:[(0,F.jsx)(r.A,{variant:"h6",children:R.name}),(0,F.jsx)(r.A,{variant:"body2",color:"text.secondary",children:R.description})]}),(0,F.jsxs)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,F.jsx)(p.A,{label:(null===(e=R.attributes)||void 0===e?void 0:e.suiteType)||"Standard",color:"primary",variant:"outlined"}),(()=>{const e=["af03b272-1efc-4458-bfb2-bded0cba4ef4","e03a5845-b768-4517-8cc1-29d7656298a4","09c2e6be-e371-49a5-b476-4e09a7632997","780944e8-324b-4e46-a044-1d3c6e710ff8","63d8e961-0fff-46f6-8561-cc16111b9251","034c57df-d80b-4cac-a47b-b6e097430120"].includes(R.id),s=M(R),t=e?"OCCUPIED":s;return"OCCUPIED"===t||e?(0,F.jsx)(p.A,{label:"Occupied",color:"error"}):"MAINTENANCE"===t?(0,F.jsx)(p.A,{label:"Maintenance",color:"default"}):(0,F.jsx)(p.A,{label:"Available",color:"success"})})()]}),(null===(s=R.reservations)||void 0===s?void 0:s.length)>0&&(0,F.jsx)(j.A,{variant:"outlined",children:(0,F.jsxs)(m.A,{children:[(0,F.jsx)(r.A,{variant:"subtitle1",children:"Current Occupant"}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Pet:"})," ",(null===(t=R.reservations[0].pet)||void 0===t?void 0:t.name)||"Unknown"," (",(null===(b=R.reservations[0].pet)||void 0===b?void 0:b.type)||"Unknown",")"]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Owner:"})," ",null!==(y=R.reservations[0].pet)&&void 0!==y&&y.owner?"".concat(R.reservations[0].pet.owner.firstName," ").concat(R.reservations[0].pet.owner.lastName):R.reservations[0].customer?"".concat(R.reservations[0].customer.firstName," ").concat(R.reservations[0].customer.lastName):"Unknown"]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Check-in:"})," ",new Date(R.reservations[0].startDate).toLocaleDateString()]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Check-out:"})," ",new Date(R.reservations[0].endDate).toLocaleDateString()]})]})}),(0,F.jsxs)(l.A,{children:[(0,F.jsx)(r.A,{variant:"subtitle1",children:"Suite Information"}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Suite Number:"})," ",(null===(S=R.attributes)||void 0===S?void 0:S.suiteNumber)||"N/A"]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Last Cleaned:"})," ",(0,F.jsx)("span",{style:{background:H?"#E3FCEF":void 0,color:H?"#388E3C":void 0,padding:H?"2px 6px":void 0,borderRadius:H?"4px":void 0},children:null!==(C=R.attributes)&&void 0!==C&&C.lastCleaned?new Date(R.attributes.lastCleaned).toLocaleString():"Never"})]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Location:"})," ",(null===(E=R.attributes)||void 0===E?void 0:E.location)||"Main Building"]}),(0,F.jsxs)(r.A,{children:[(0,F.jsx)("strong",{children:"Amenities:"})," ",(null===(N=R.attributes)||void 0===N||null===(D=N.amenities)||void 0===D?void 0:D.join(", "))||"None"]})]}),R.notes&&(0,F.jsxs)(l.A,{children:[(0,F.jsx)(r.A,{variant:"subtitle1",children:"Notes"}),(0,F.jsx)(r.A,{variant:"body2",whiteSpace:"pre-line",children:R.notes})]})]}):(0,F.jsx)(r.A,{children:"No suite details available"})}),(0,F.jsxs)(g.A,{children:[R&&!(null!==(w=R.reservations)&&void 0!==w&&w.length)&&(0,F.jsx)(c.A,{onClick:()=>{T&&R&&(k(!0),U.c.updateSuiteCleaning(T,{maintenanceStatus:"AVAILABLE",notes:R.notes||""}).then(e=>{"success"===(null===e||void 0===e?void 0:e.status)&&null!==e&&void 0!==e&&e.data&&(L((0,n.A)((0,n.A)({},R),{},{attributes:(0,n.A)((0,n.A)({},R.attributes),{},{lastCleaned:(new Date).toISOString(),maintenanceStatus:"AVAILABLE"})})),Y(!0),q(),setTimeout(()=>Y(!1),3e3))}).catch(e=>{console.error("Error updating suite cleaning status:",e)}).finally(()=>{k(!1)}))},color:"primary",disabled:P,children:"Mark as Cleaned"}),(0,F.jsx)(c.A,{onClick:()=>I(null),children:"Close"})]})]})]})}}}]);
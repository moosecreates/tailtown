"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[8866],{58866:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var n=s(89379),r=s(9950),i=s(78317),o=s(46639),a=s(48089),l=s(50704),c=s(82053),d=s(57357),p=s(14195),h=s(41413),x=s(83563),m=s(25277),g=s(25333),A=s(66699),y=s(33738),j=s(249),u=s(26050),k=s(93038),f=s(52472),v=s(53256),b=s(39972),w=s(11227),C=s(35834),S=s(5022),P=s(424),T=s(31213),B=s(65833),D=s(91367),I=s(44414);T.l;const N=()=>{const{user:e}=(0,D.As)(),[t,s]=(0,r.useState)([]),[T,N]=(0,r.useState)(!0),[z,E]=(0,r.useState)(null);(0,r.useEffect)(()=>{O()},[]);const O=async()=>{try{N(!0);const e=(await B.A.getPendingTasks()).map(e=>({id:e.id,title:e.title,type:e.type,dueDate:e.dueDate,tasks:R(e.id,e.total,e.completed)}));s(e)}catch(e){console.error("Error fetching checklists:",e)}finally{N(!1)}},R=(t,s,n)=>{const r=["Unlock doors","Turn on lights","Check temperature","Inspect play areas","Prepare feeding stations","Check water bowls","Clean kennels","Medication prep","Safety inspection","Log morning notes"];return Array.from({length:s},(s,i)=>({id:"".concat(t,"-task-").concat(i),title:r[i]||"Task ".concat(i+1),completed:i<n,completedAt:i<n?(new Date).toISOString():void 0,completedBy:i<n?null===e||void 0===e?void 0:e.firstName:void 0}))};return T?(0,I.jsxs)(i.A,{children:[(0,I.jsx)(P.i,{title:"Checklists",showNotifications:!0}),(0,I.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,I.jsx)(o.A,{})})]}):(0,I.jsxs)(i.A,{sx:{pb:8},children:[(0,I.jsx)(P.i,{title:"Checklists",showNotifications:!0}),(0,I.jsx)(i.A,{sx:{p:2,pb:10},children:0===t.length?(0,I.jsx)(a.A,{elevation:1,children:(0,I.jsx)(l.A,{sx:{textAlign:"center",py:4},children:(0,I.jsx)(c.A,{variant:"body1",color:"text.secondary",children:"No checklists assigned"})})}):t.map(t=>{const o=(e=>{const t=e.tasks.filter(e=>e.completed).length,s=e.tasks.length;return{completed:t,total:s,percentage:t/s*100}})(t),c=z===t.id,f=100===(v=o.percentage)?"success":v>=50?"warning":"error";var v;return(0,I.jsx)(a.A,{elevation:1,sx:{mb:2},children:(0,I.jsxs)(l.A,{sx:{pb:1},children:[(0,I.jsxs)(d.A,{onClick:()=>{return e=t.id,void E(z===e?null:e);var e},sx:{px:0,borderRadius:1},children:[(0,I.jsx)(p.A,{children:(0,I.jsx)(h.A,{sx:{bgcolor:100===o.percentage?"success.light":"primary.light",width:40,height:40},children:100===o.percentage?(0,I.jsx)(w.A,{}):(0,I.jsx)(S.A,{})})}),(0,I.jsx)(x.A,{primary:t.title,secondary:"".concat(o.completed,"/").concat(o.total," tasks completed"),primaryTypographyProps:{fontWeight:600}}),(0,I.jsx)(m.A,{label:"".concat(Math.round(o.percentage),"%"),size:"small",color:f,sx:{mr:1}}),(0,I.jsx)(g.A,{size:"small",sx:{transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"},children:(0,I.jsx)(C.A,{})})]}),(0,I.jsx)(A.A,{variant:"determinate",value:o.percentage,color:f,sx:{mt:1,mb:2,borderRadius:1,height:6}}),(0,I.jsx)(y.A,{in:c,timeout:"auto",unmountOnExit:!0,children:(0,I.jsx)(j.A,{disablePadding:!0,children:t.tasks.map((o,a)=>(0,I.jsxs)(r.Fragment,{children:[(0,I.jsx)(u.Ay,{disablePadding:!0,secondaryAction:o.completed&&(0,I.jsx)(g.A,{edge:"end",size:"small",children:(0,I.jsx)(b.A,{fontSize:"small"})}),children:(0,I.jsxs)(d.A,{onClick:()=>{return r=t.id,i=o.id,void s(t=>t.map(t=>t.id===r?(0,n.A)((0,n.A)({},t),{},{tasks:t.tasks.map(t=>t.id===i?(0,n.A)((0,n.A)({},t),{},{completed:!t.completed,completedAt:t.completed?void 0:(new Date).toISOString(),completedBy:t.completed||null===e||void 0===e?void 0:e.firstName}):t)}):t));var r,i},dense:!0,children:[(0,I.jsx)(p.A,{sx:{minWidth:40},children:(0,I.jsx)(k.A,{edge:"start",checked:o.completed,tabIndex:-1,disableRipple:!0})}),(0,I.jsx)(x.A,{primary:o.title,secondary:o.completed&&o.completedBy?"Completed by ".concat(o.completedBy):void 0,primaryTypographyProps:{style:{textDecoration:o.completed?"line-through":"none",color:o.completed?"text.secondary":"text.primary"}},secondaryTypographyProps:{variant:"caption"}})]})}),a<t.tasks.length-1&&(0,I.jsx)(i.A,{sx:{borderBottom:1,borderColor:"divider",ml:7}})]},o.id))})})]})},t.id)})}),(0,I.jsx)(f.A,{color:"primary",sx:{position:"fixed",bottom:80,right:16},children:(0,I.jsx)(v.A,{})})]})}}}]);
"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[9284],{79284:(e,t,i)=>{i.r(t),i.d(t,{default:()=>B});var s=i(9950),a=i(62999),n=i(78317),l=i(89379),r=i(80045),o=i(48089),d=i(50704),c=i(60899),x=i(82053),A=i(25277),u=i(10226),v=i(46639),y=i(45180),h=i(65429),j=i(69019),m=i(84142),b=i(96583),p=i(40033),N=i(28170),f=i(74745),C=i(79739),g=i(4477),w=i(73753),E=i(7168),D=i(6163),I=i(89299),R=i(66387),S=i(82932);const T=new class{async addToWaitlist(e){return(await S.Ay.post("/api/waitlist",e)).data.data}async getMyEntries(e){return(await S.Ay.get("/api/waitlist/my-entries",{params:{customerId:e}})).data.data}async removeFromWaitlist(e){await S.Ay.delete("/api/waitlist/".concat(e))}async getPosition(e){return(await S.Ay.get("/api/waitlist/".concat(e,"/position"))).data.data}async listEntries(e){return(await S.Ay.get("/api/waitlist",{params:e})).data.data}async updateEntry(e,t){return(await S.Ay.patch("/api/waitlist/".concat(e),t)).data.data}async convertToReservation(e,t){return(await S.Ay.post("/api/waitlist/".concat(e,"/convert"),{reservationId:t})).data.data}async checkAvailability(e){return(await S.Ay.post("/api/waitlist/check-availability",e)).data.data}formatServiceType(e){return{BOARDING:"Boarding",DAYCARE:"Daycare",GROOMING:"Grooming",TRAINING:"Training"}[e]||e}formatStatus(e){return{ACTIVE:"Active",NOTIFIED:"Notified",CONVERTED:"Converted",EXPIRED:"Expired",CANCELLED:"Cancelled"}[e]||e}getStatusColor(e){return{ACTIVE:"info",NOTIFIED:"warning",CONVERTED:"success",EXPIRED:"default",CANCELLED:"error"}[e]||"default"}};var G=i(43974),M=i(44414);const O=["children","value","index"];function k(e){const{children:t,value:i,index:s}=e,a=(0,r.A)(e,O);return(0,M.jsx)("div",(0,l.A)((0,l.A)({role:"tabpanel",hidden:i!==s,id:"waitlist-tabpanel-".concat(s),"aria-labelledby":"waitlist-tab-".concat(s)},a),{},{children:i===s&&(0,M.jsx)(n.A,{sx:{p:3},children:t})}))}const q=()=>{var e,t,i,a,l,r,S,O,q,B,F,P,W,L,V,Y,z,X,_,Q,H,J,K;const[U,Z]=(0,s.useState)(0),[$,ee]=(0,s.useState)(!0),[te,ie]=(0,s.useState)([]),[se,ae]=(0,s.useState)({}),[ne,le]=(0,s.useState)(null),[re,oe]=(0,s.useState)(null),[de,ce]=(0,s.useState)(!1),[xe,Ae]=(0,s.useState)(!1),[ue,ve]=(0,s.useState)(null);(0,s.useEffect)(()=>{ye()},[]);const ye=async()=>{try{ee(!0),ve(null);const e=await T.listEntries();ie(e.entries),ae(e.grouped),le(e.summary)}catch(e){ve(e.message||"Failed to load waitlist")}finally{ee(!1)}},he=async e=>{oe(e),Ae(!0)},je=e=>{var t,i,s,a,l;return(0,M.jsx)(o.A,{sx:{mb:2},children:(0,M.jsxs)(d.A,{children:[(0,M.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(c.Ay,{item:!0,xs:12,md:6,children:[(0,M.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,M.jsx)(n.A,{sx:{mr:1},children:(l=e.serviceType,{BOARDING:(0,M.jsx)(g.A,{}),DAYCARE:(0,M.jsx)(w.A,{}),GROOMING:(0,M.jsx)(E.A,{}),TRAINING:(0,M.jsx)(D.A,{})}[l]||(0,M.jsx)(I.A,{}))}),(0,M.jsxs)(x.A,{variant:"h6",children:[null===(t=e.customer)||void 0===t?void 0:t.firstName," ",null===(i=e.customer)||void 0===i?void 0:i.lastName]})]}),(0,M.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Pet: ",null===(s=e.pet)||void 0===s?void 0:s.name," (",null===(a=e.pet)||void 0===a?void 0:a.type,")"]}),(0,M.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Requested: ",(0,G.A)(new Date(e.requestedStartDate),"MMM dd, yyyy"),e.requestedEndDate&&" - ".concat((0,G.A)(new Date(e.requestedEndDate),"MMM dd, yyyy"))]})]}),(0,M.jsx)(c.Ay,{item:!0,xs:12,md:3,children:(0,M.jsxs)(n.A,{sx:{textAlign:"center"},children:[(0,M.jsxs)(x.A,{variant:"h4",color:"primary",children:["#",e.position]}),(0,M.jsx)(x.A,{variant:"caption",color:"text.secondary",children:"Position in Queue"})]})}),(0,M.jsx)(c.Ay,{item:!0,xs:12,md:3,children:(0,M.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,M.jsx)(A.A,{label:T.formatStatus(e.status),color:T.getStatusColor(e.status),size:"small"}),(0,M.jsx)(u.A,{size:"small",variant:"outlined",startIcon:(0,M.jsx)(R.A,{}),onClick:()=>he(e),disabled:"ACTIVE"!==e.status,children:"Notify"}),(0,M.jsx)(u.A,{size:"small",variant:"text",onClick:()=>(e=>{oe(e),ce(!0)})(e),children:"Details"})]})})]}),e.customerNotes&&(0,M.jsxs)(n.A,{sx:{mt:2,p:1,bgcolor:"background.default",borderRadius:1},children:[(0,M.jsx)(x.A,{variant:"caption",color:"text.secondary",children:"Customer Notes:"}),(0,M.jsx)(x.A,{variant:"body2",children:e.customerNotes})]})]})},e.id)};return $?(0,M.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,M.jsx)(v.A,{})}):(0,M.jsxs)(n.A,{children:[(0,M.jsxs)(o.A,{children:[(0,M.jsx)(y.A,{title:"Waitlist Management",subheader:"".concat((null===ne||void 0===ne?void 0:ne.total)||0," total entries"),action:(0,M.jsx)(u.A,{variant:"contained",startIcon:(0,M.jsx)(R.A,{}),onClick:ye,children:"Refresh"})}),ue&&(0,M.jsx)(h.A,{severity:"error",sx:{m:2},children:ue}),(0,M.jsx)(n.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,M.jsxs)(j.A,{value:U,onChange:(e,t)=>{Z(t)},"aria-label":"waitlist tabs",children:[(0,M.jsx)(m.A,{label:"All (".concat((null===ne||void 0===ne?void 0:ne.total)||0,")")}),(0,M.jsx)(m.A,{label:"Boarding (".concat((null===(e=se.BOARDING)||void 0===e?void 0:e.length)||0,")")}),(0,M.jsx)(m.A,{label:"Daycare (".concat((null===(t=se.DAYCARE)||void 0===t?void 0:t.length)||0,")")}),(0,M.jsx)(m.A,{label:"Grooming (".concat((null===(i=se.GROOMING)||void 0===i?void 0:i.length)||0,")")}),(0,M.jsx)(m.A,{label:"Training (".concat((null===(a=se.TRAINING)||void 0===a?void 0:a.length)||0,")")})]})}),(0,M.jsx)(k,{value:U,index:0,children:0===te.length?(0,M.jsx)(h.A,{severity:"info",children:"No waitlist entries"}):te.map(je)}),(0,M.jsx)(k,{value:U,index:1,children:0===(null===(l=se.BOARDING)||void 0===l?void 0:l.length)?(0,M.jsx)(h.A,{severity:"info",children:"No boarding waitlist entries"}):null===(r=se.BOARDING)||void 0===r?void 0:r.map(je)}),(0,M.jsx)(k,{value:U,index:2,children:0===(null===(S=se.DAYCARE)||void 0===S?void 0:S.length)?(0,M.jsx)(h.A,{severity:"info",children:"No daycare waitlist entries"}):null===(O=se.DAYCARE)||void 0===O?void 0:O.map(je)}),(0,M.jsx)(k,{value:U,index:3,children:0===(null===(q=se.GROOMING)||void 0===q?void 0:q.length)?(0,M.jsx)(h.A,{severity:"info",children:"No grooming waitlist entries"}):null===(B=se.GROOMING)||void 0===B?void 0:B.map(je)}),(0,M.jsx)(k,{value:U,index:4,children:0===(null===(F=se.TRAINING)||void 0===F?void 0:F.length)?(0,M.jsx)(h.A,{severity:"info",children:"No training waitlist entries"}):null===(P=se.TRAINING)||void 0===P?void 0:P.map(je)})]}),(0,M.jsxs)(b.A,{open:de,onClose:()=>ce(!1),maxWidth:"md",fullWidth:!0,children:[(0,M.jsx)(p.A,{children:"Waitlist Entry Details"}),(0,M.jsx)(N.A,{children:re&&(0,M.jsx)(n.A,{children:(0,M.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Customer"}),(0,M.jsxs)(x.A,{variant:"body1",children:[null===(W=re.customer)||void 0===W?void 0:W.firstName," ",null===(L=re.customer)||void 0===L?void 0:L.lastName]}),(0,M.jsx)(x.A,{variant:"body2",color:"text.secondary",children:null===(V=re.customer)||void 0===V?void 0:V.email}),(0,M.jsx)(x.A,{variant:"body2",color:"text.secondary",children:null===(Y=re.customer)||void 0===Y?void 0:Y.phone})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Pet"}),(0,M.jsx)(x.A,{variant:"body1",children:null===(z=re.pet)||void 0===z?void 0:z.name}),(0,M.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:[null===(X=re.pet)||void 0===X?void 0:X.type," - ",null===(_=re.pet)||void 0===_?void 0:_.breed]})]}),(0,M.jsx)(c.Ay,{item:!0,xs:12,children:(0,M.jsx)(f.A,{sx:{my:2}})}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Service Type"}),(0,M.jsx)(x.A,{variant:"body1",children:T.formatServiceType(re.serviceType)})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Status"}),(0,M.jsx)(A.A,{label:T.formatStatus(re.status),color:T.getStatusColor(re.status),size:"small"})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Requested Dates"}),(0,M.jsxs)(x.A,{variant:"body1",children:[(0,G.A)(new Date(re.requestedStartDate),"MMM dd, yyyy"),re.requestedEndDate&&" - ".concat((0,G.A)(new Date(re.requestedEndDate),"MMM dd, yyyy"))]})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Position"}),(0,M.jsxs)(x.A,{variant:"body1",children:["#",re.position]})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Flexible Dates"}),(0,M.jsx)(x.A,{variant:"body1",children:re.flexibleDates?"Yes (\xb1".concat(re.dateFlexibilityDays," days)"):"No"})]}),(0,M.jsxs)(c.Ay,{item:!0,xs:6,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Notifications Sent"}),(0,M.jsx)(x.A,{variant:"body1",children:re.notificationsSent})]}),re.customerNotes&&(0,M.jsxs)(c.Ay,{item:!0,xs:12,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Customer Notes"}),(0,M.jsx)(x.A,{variant:"body1",children:re.customerNotes})]}),re.notes&&(0,M.jsxs)(c.Ay,{item:!0,xs:12,children:[(0,M.jsx)(x.A,{variant:"subtitle2",color:"text.secondary",children:"Staff Notes"}),(0,M.jsx)(x.A,{variant:"body1",children:re.notes})]})]})})}),(0,M.jsxs)(C.A,{children:[(0,M.jsx)(u.A,{onClick:()=>ce(!1),children:"Close"}),re&&"ACTIVE"===re.status&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(u.A,{variant:"outlined",color:"error",onClick:()=>{(async e=>{try{await T.updateEntry(e,{status:"CANCELLED"}),await ye()}catch(t){ve(t.message||"Failed to cancel entry")}})(re.id),ce(!1)},children:"Cancel Entry"}),(0,M.jsx)(u.A,{variant:"contained",onClick:()=>{ce(!1),he(re)},children:"Notify Customer"})]})]})]}),(0,M.jsxs)(b.A,{open:xe,onClose:()=>Ae(!1),children:[(0,M.jsx)(p.A,{children:"Notify Customer"}),(0,M.jsxs)(N.A,{children:[(0,M.jsx)(x.A,{variant:"body2",sx:{mb:2},children:"This will send a notification to the customer that a spot is available."}),re&&(0,M.jsxs)(h.A,{severity:"info",children:["Customer: ",null===(Q=re.customer)||void 0===Q?void 0:Q.firstName," ",null===(H=re.customer)||void 0===H?void 0:H.lastName,(0,M.jsx)("br",{}),"Email: ",null===(J=re.customer)||void 0===J?void 0:J.email,(0,M.jsx)("br",{}),"Phone: ",null===(K=re.customer)||void 0===K?void 0:K.phone]})]}),(0,M.jsxs)(C.A,{children:[(0,M.jsx)(u.A,{onClick:()=>Ae(!1),children:"Cancel"}),(0,M.jsx)(u.A,{variant:"contained",onClick:async()=>{Ae(!1),alert("Notification feature coming soon!")},children:"Send Notification"})]})]})]})},B=()=>(0,M.jsx)(a.A,{maxWidth:"xl",children:(0,M.jsx)(n.A,{sx:{py:3},children:(0,M.jsx)(q,{})})})}}]);
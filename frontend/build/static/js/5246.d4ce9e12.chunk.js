"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[5246],{15246:(e,n,t)=>{t.r(n),t.d(n,{default:()=>V});var a=t(89379),s=t(9950),i=t(62999),l=t(78317),o=t(82053),r=t(10226),c=t(65429),d=t(2235),h=t(8145),u=t(25979),x=t(19647),A=t(70006),m=t(23266),g=t(46639),j=t(1320),p=t(15769),f=t(69780),S=t(9213),b=t(21671),v=t(34075),y=t(25277),C=t(83274),T=t(25333),w=t(96583),E=t(40033),z=t(28170),k=t(16497),W=t(37324),N=t(79739),I=t(29240),P=t(53256),L=t(49939),D=t(40379),R=t(26014),q=t(41770),B=t(11227),F=t(20760),O=t(41445),U=t(26910),J=t(28429),_=t(44414);const M=e=>{let{tenant:n,onStatusChange:t}=e;(0,J.Zp)();const[a,i]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[x,A]=(0,s.useState)(!1),[m,g]=(0,s.useState)(""),[j,p]=(0,s.useState)(""),[f,S]=(0,s.useState)(""),[b,v]=(0,s.useState)(!1),[k,W]=(0,s.useState)(""),I=window.location.origin,P=()=>localStorage.getItem("superAdminAccessToken");if(!!!P())return null;const L="PAUSED"===n.status||n.isPaused,D="DELETED"===n.status||n.deletedAt,M="ACTIVE"===n.status&&n.isActive;return(0,_.jsxs)(l.A,{sx:{display:"inline-flex",gap:.25,alignItems:"center"},children:[(0,_.jsx)(y.A,{label:n.status||"ACTIVE",color:(e=>{switch(e){case"ACTIVE":return"success";case"PAUSED":return"warning";case"DELETED":return"error";case"TRIAL":return"info";default:return"default"}})(n.status),size:"small",sx:{height:20,fontSize:"0.7rem"}}),k&&(0,_.jsx)(c.A,{severity:"error",sx:{position:"fixed",top:80,right:20,zIndex:9999},onClose:()=>W(""),children:k}),(M||L)&&!D&&(0,_.jsx)(C.A,{title:"Login as Tenant",children:(0,_.jsx)(T.A,{size:"small",color:"primary",onClick:()=>A(!0),disabled:b,sx:{p:.5},children:(0,_.jsx)(R.A,{sx:{fontSize:16}})})}),M&&(0,_.jsx)(C.A,{title:"Suspend",children:(0,_.jsx)(T.A,{size:"small",color:"warning",onClick:()=>i(!0),disabled:b,sx:{p:.5},children:(0,_.jsx)(q.A,{sx:{fontSize:16}})})}),L&&!D&&(0,_.jsx)(C.A,{title:"Activate",children:(0,_.jsx)(T.A,{size:"small",color:"success",onClick:async()=>{v(!0),W("");try{await U.A.post("".concat(I,"/api/super-admin/tenants/").concat(n.id,"/activate"),{},{headers:{Authorization:"Bearer ".concat(P())}}),t()}catch(s){var e,a;W((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to activate tenant")}finally{v(!1)}},disabled:b,sx:{p:.5},children:(0,_.jsx)(B.A,{sx:{fontSize:16}})})}),!D&&(0,_.jsx)(C.A,{title:"Delete",children:(0,_.jsx)(T.A,{size:"small",color:"error",onClick:()=>u(!0),disabled:b,sx:{p:.5},children:(0,_.jsx)(F.A,{sx:{fontSize:16}})})}),D&&(0,_.jsx)(C.A,{title:"Restore",children:(0,_.jsx)(T.A,{size:"small",color:"success",onClick:async()=>{v(!0),W("");try{await U.A.post("".concat(I,"/api/super-admin/tenants/").concat(n.id,"/restore"),{},{headers:{Authorization:"Bearer ".concat(P())}}),t()}catch(s){var e,a;W((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to restore tenant")}finally{v(!1)}},disabled:b,sx:{p:.5},children:(0,_.jsx)(O.A,{sx:{fontSize:16}})})}),(0,_.jsxs)(w.A,{open:a,onClose:()=>i(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(E.A,{children:"Suspend Tenant"}),(0,_.jsxs)(z.A,{children:[(0,_.jsx)(o.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Suspending this tenant will prevent all users from accessing the system. The account can be reactivated at any time."}),(0,_.jsx)(h.A,{fullWidth:!0,label:"Suspension Reason",multiline:!0,rows:3,value:m,onChange:e=>g(e.target.value),required:!0,helperText:"Required: Explain why this tenant is being suspended"})]}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>i(!1),children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{if(m.trim()){v(!0),W("");try{await U.A.post("".concat(I,"/api/super-admin/tenants/").concat(n.id,"/suspend"),{reason:m},{headers:{Authorization:"Bearer ".concat(P())}}),i(!1),g(""),t()}catch(s){var e,a;W((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to suspend tenant")}finally{v(!1)}}else W("Suspension reason is required")},color:"warning",variant:"contained",disabled:b||!m.trim(),children:b?"Suspending...":"Suspend Tenant"})]})]}),(0,_.jsxs)(w.A,{open:d,onClose:()=>u(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(E.A,{children:"Delete Tenant"}),(0,_.jsxs)(z.A,{children:[(0,_.jsx)(c.A,{severity:"warning",sx:{mb:2},children:"This is a soft delete. The tenant can be restored within 1 year. After 1 year, all data will be permanently deleted."}),(0,_.jsxs)(o.A,{variant:"body2",sx:{mb:2},children:[(0,_.jsx)("strong",{children:"Tenant:"})," ",n.businessName]}),(0,_.jsx)(h.A,{fullWidth:!0,label:"Deletion Reason (Optional)",multiline:!0,rows:3,value:j,onChange:e=>p(e.target.value),helperText:"Optional: Explain why this tenant is being deleted"})]}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>u(!1),children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{v(!0),W("");try{await U.A.delete("".concat(I,"/api/super-admin/tenants/").concat(n.id),{headers:{Authorization:"Bearer ".concat(P())},data:{reason:j}}),u(!1),p(""),t()}catch(s){var e,a;W((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to delete tenant")}finally{v(!1)}},color:"error",variant:"contained",disabled:b,children:b?"Deleting...":"Delete Tenant"})]})]}),(0,_.jsxs)(w.A,{open:x,onClose:()=>A(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(E.A,{children:"Login as Tenant"}),(0,_.jsxs)(z.A,{children:[(0,_.jsx)(c.A,{severity:"info",sx:{mb:2},children:"You will be logged in as this tenant for support purposes. Session will automatically expire after 30 minutes."}),(0,_.jsxs)(o.A,{variant:"body2",sx:{mb:2},children:[(0,_.jsx)("strong",{children:"Tenant:"})," ",n.businessName," (",n.subdomain,")"]}),(0,_.jsx)(h.A,{fullWidth:!0,label:"Reason for Impersonation",multiline:!0,rows:3,value:f,onChange:e=>S(e.target.value),required:!0,helperText:"Required: Why are you logging in as this tenant?"})]}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>A(!1),children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{if(f.trim()){v(!0),W("");try{const e=await U.A.post("".concat(I,"/api/super-admin/impersonate/").concat(n.id),{reason:f},{headers:{Authorization:"Bearer ".concat(P())}});if(e.data.success){const n=e.data.data.impersonationToken,t=e.data.data.session;localStorage.setItem("impersonationToken",n),localStorage.setItem("impersonationSession",JSON.stringify(t)),localStorage.setItem("accessToken",n),localStorage.setItem("token",n),localStorage.setItem("tokenTimestamp",Date.now().toString()),t.subdomain&&(localStorage.setItem("tailtown_tenant_id",t.subdomain),localStorage.setItem("tenantId",t.subdomain));const a={id:"impersonated-super-admin",email:t.superAdminEmail||"super-admin",firstName:"Super",lastName:"Admin",role:"SUPER_ADMIN"};localStorage.setItem("user",JSON.stringify(a)),localStorage.removeItem("businessLogo"),localStorage.removeItem("businessName"),localStorage.removeItem("businessSettings"),localStorage.removeItem("customer"),localStorage.removeItem("customers"),localStorage.removeItem("pets"),localStorage.removeItem("staff"),window.location.replace("/dashboard?t=".concat(Date.now()))}}catch(a){var e,t;W((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to start impersonation")}finally{v(!1)}}else W("Reason for impersonation is required")},color:"primary",variant:"contained",disabled:b||!f.trim(),startIcon:(0,_.jsx)(R.A,{}),children:b?"Starting Session...":"Login as Tenant"})]})]})]})},V=()=>{const[e,n]=(0,s.useState)([]),[t,R]=(0,s.useState)(!0),[q,B]=(0,s.useState)(""),[F,O]=(0,s.useState)(""),[U,J]=(0,s.useState)("ALL"),[V,G]=(0,s.useState)("ALL"),[Y,H]=(0,s.useState)("ALL"),[Z,K]=(0,s.useState)(""),[Q,X]=(0,s.useState)(!1),[$,ee]=(0,s.useState)(!1),[ne,te]=(0,s.useState)(!1),[ae,se]=(0,s.useState)(null),[ie,le]=(0,s.useState)({businessName:"",subdomain:"",contactName:"",contactEmail:"",contactPhone:"",isProduction:!1,isTemplate:!1,gingrSyncEnabled:!1,planType:"STARTER"}),oe=window.location.origin,re=s.useCallback(async()=>{try{R(!0),B("");const e=new URLSearchParams;"ALL"!==U&&e.append("status",U),"ALL"!==V&&e.append("isProduction",V),"ALL"!==Y&&e.append("isTemplate",Y),Z&&e.append("search",Z);const t=await fetch("".concat(oe,"/api/super-admin/tenants?").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("superAdminAccessToken"))}});if(!t.ok)throw new Error("Failed to load tenants");const a=await t.json();n(a.data.tenants)}catch(e){B(e.message)}finally{R(!1)}},[U,V,Y,Z,oe]);(0,s.useEffect)(()=>{re()},[re]);const ce=()=>{le({businessName:"",subdomain:"",contactName:"",contactEmail:"",contactPhone:"",isProduction:!1,isTemplate:!1,gingrSyncEnabled:!1,planType:"STARTER"}),se(null)},de=e=>e.deletedAt?"error":e.suspendedAt?"warning":e.isActive?"success":"default",he=e=>e.deletedAt?"DELETED":e.suspendedAt?"SUSPENDED":e.status;return(0,_.jsxs)(i.A,{maxWidth:"xl",sx:{mt:2,mb:2},children:[(0,_.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,_.jsxs)(l.A,{children:[(0,_.jsx)(o.A,{variant:"h5",children:"Tenant Management"}),(0,_.jsxs)(o.A,{variant:"caption",color:"text.secondary",children:[e.length," tenant",1!==e.length?"s":""]})]}),(0,_.jsxs)(l.A,{sx:{display:"flex",gap:1},children:[(0,_.jsx)(r.A,{size:"small",variant:"outlined",startIcon:(0,_.jsx)(I.A,{}),onClick:re,children:"Refresh"}),(0,_.jsx)(r.A,{size:"small",variant:"contained",startIcon:(0,_.jsx)(P.A,{}),onClick:()=>X(!0),children:"Create"})]})]}),q&&(0,_.jsx)(c.A,{severity:"error",onClose:()=>B(""),sx:{mb:2},children:q}),F&&(0,_.jsx)(c.A,{severity:"success",onClose:()=>O(""),sx:{mb:2},children:F}),(0,_.jsx)(d.A,{sx:{p:1.5,mb:2},children:(0,_.jsxs)(l.A,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[(0,_.jsx)(h.A,{label:"Search",size:"small",value:Z,onChange:e=>K(e.target.value),placeholder:"Name, subdomain, email...",sx:{minWidth:200,"& .MuiInputBase-root":{fontSize:"0.875rem"}}}),(0,_.jsxs)(u.A,{size:"small",sx:{minWidth:120},children:[(0,_.jsx)(x.A,{sx:{fontSize:"0.875rem"},children:"Status"}),(0,_.jsxs)(A.A,{value:U,label:"Status",onChange:e=>J(e.target.value),sx:{fontSize:"0.875rem"},children:[(0,_.jsx)(m.A,{value:"ALL",children:"All"}),(0,_.jsx)(m.A,{value:"ACTIVE",children:"Active"}),(0,_.jsx)(m.A,{value:"TRIAL",children:"Trial"}),(0,_.jsx)(m.A,{value:"PAUSED",children:"Paused"}),(0,_.jsx)(m.A,{value:"CANCELLED",children:"Cancelled"})]})]}),(0,_.jsxs)(u.A,{size:"small",sx:{minWidth:100},children:[(0,_.jsx)(x.A,{sx:{fontSize:"0.875rem"},children:"Prod"}),(0,_.jsxs)(A.A,{value:V,label:"Prod",onChange:e=>G(e.target.value),sx:{fontSize:"0.875rem"},children:[(0,_.jsx)(m.A,{value:"ALL",children:"All"}),(0,_.jsx)(m.A,{value:"true",children:"Yes"}),(0,_.jsx)(m.A,{value:"false",children:"No"})]})]}),(0,_.jsxs)(u.A,{size:"small",sx:{minWidth:100},children:[(0,_.jsx)(x.A,{sx:{fontSize:"0.875rem"},children:"Template"}),(0,_.jsxs)(A.A,{value:Y,label:"Template",onChange:e=>H(e.target.value),sx:{fontSize:"0.875rem"},children:[(0,_.jsx)(m.A,{value:"ALL",children:"All"}),(0,_.jsx)(m.A,{value:"true",children:"Yes"}),(0,_.jsx)(m.A,{value:"false",children:"No"})]})]})]})}),t?(0,_.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,_.jsx)(g.A,{})}):(0,_.jsx)(j.A,{component:d.A,children:(0,_.jsxs)(p.A,{size:"small",sx:{"& .MuiTableCell-root":{py:.75,fontSize:"0.8125rem"}},children:[(0,_.jsx)(f.A,{children:(0,_.jsxs)(S.A,{sx:{bgcolor:"grey.50"},children:[(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Business / Contact"}),(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Subdomain"}),(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Status"}),(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Flags"}),(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Stats"}),(0,_.jsx)(b.A,{sx:{fontWeight:600},children:"Created"}),(0,_.jsx)(b.A,{align:"right",sx:{fontWeight:600},children:"Actions"})]})}),(0,_.jsxs)(v.A,{children:[e.map(e=>(0,_.jsxs)(S.A,{sx:{"&:hover":{bgcolor:"action.hover"}},children:[(0,_.jsxs)(b.A,{children:[(0,_.jsx)(o.A,{variant:"body2",fontWeight:500,sx:{fontSize:"0.8125rem"},children:e.businessName}),(0,_.jsx)(o.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:e.contactEmail})]}),(0,_.jsx)(b.A,{children:(0,_.jsx)(o.A,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.75rem"},children:e.subdomain})}),(0,_.jsx)(b.A,{children:(0,_.jsx)(y.A,{label:he(e),color:de(e),size:"small",sx:{height:20,fontSize:"0.7rem"}})}),(0,_.jsx)(b.A,{children:(0,_.jsxs)(l.A,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:[e.isProduction&&(0,_.jsx)(y.A,{label:"P",color:"error",size:"small",sx:{height:18,fontSize:"0.65rem",minWidth:24}}),e.isTemplate&&(0,_.jsx)(y.A,{label:"T",color:"info",size:"small",sx:{height:18,fontSize:"0.65rem",minWidth:24}}),e.gingrSyncEnabled&&(0,_.jsx)(y.A,{label:"G",color:"warning",size:"small",sx:{height:18,fontSize:"0.65rem",minWidth:24}})]})}),(0,_.jsx)(b.A,{children:(0,_.jsxs)(o.A,{variant:"caption",sx:{fontSize:"0.75rem"},children:[e.customerCount,"c / ",e.reservationCount,"r"]})}),(0,_.jsx)(b.A,{children:(0,_.jsx)(o.A,{variant:"caption",sx:{fontSize:"0.75rem"},children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"})})}),(0,_.jsx)(b.A,{align:"right",children:(0,_.jsxs)(l.A,{sx:{display:"flex",gap:.25,justifyContent:"flex-end"},children:[(0,_.jsx)(C.A,{title:"Clone",children:(0,_.jsx)(T.A,{size:"small",onClick:()=>(e=>{se(e),le((0,a.A)((0,a.A)({},ie),{},{businessName:"",subdomain:"",contactName:"",contactEmail:"",contactPhone:""})),ee(!0)})(e),sx:{p:.5},children:(0,_.jsx)(L.A,{sx:{fontSize:16}})})}),(0,_.jsx)(C.A,{title:"Edit",children:(0,_.jsx)(T.A,{size:"small",onClick:()=>(e=>{se(e),le((0,a.A)((0,a.A)({},ie),{},{isProduction:e.isProduction,isTemplate:e.isTemplate,gingrSyncEnabled:e.gingrSyncEnabled})),te(!0)})(e),sx:{p:.5},children:(0,_.jsx)(D.A,{sx:{fontSize:16}})})}),(0,_.jsx)(M,{tenant:e,onStatusChange:re})]})})]},e.id)),0===e.length&&(0,_.jsx)(S.A,{children:(0,_.jsx)(b.A,{colSpan:7,align:"center",children:(0,_.jsx)(o.A,{color:"text.secondary",sx:{py:4},children:"No tenants found"})})})]})]})}),(0,_.jsxs)(w.A,{open:Q,onClose:()=>X(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(E.A,{children:"Create New Tenant"}),(0,_.jsx)(z.A,{children:(0,_.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,_.jsx)(h.A,{label:"Business Name",value:ie.businessName,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{businessName:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Subdomain",value:ie.subdomain,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{subdomain:e.target.value.toLowerCase()})),required:!0,fullWidth:!0,helperText:"Will be used as: subdomain.canicloud.com"}),(0,_.jsx)(h.A,{label:"Contact Name",value:ie.contactName,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactName:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Contact Email",type:"email",value:ie.contactEmail,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactEmail:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Contact Phone",value:ie.contactPhone,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactPhone:e.target.value})),fullWidth:!0}),(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.isProduction,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{isProduction:e.target.checked}))}),label:"Production Account (protected from deletion)"}),(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.isTemplate,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{isTemplate:e.target.checked}))}),label:"Template (can be cloned)"}),(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.gingrSyncEnabled,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{gingrSyncEnabled:e.target.checked}))}),label:"Enable Gingr Sync"})]})}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>{X(!1),ce()},children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{try{B("");const e=await fetch("".concat(oe,"/api/super-admin/tenants"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("superAdminAccessToken"))},body:JSON.stringify(ie)});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to create tenant")}O("Tenant created successfully!"),X(!1),ce(),re()}catch(e){B(e.message)}},variant:"contained",children:"Create"})]})]}),(0,_.jsxs)(w.A,{open:$,onClose:()=>ee(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsxs)(E.A,{children:["Clone Tenant: ",null===ae||void 0===ae?void 0:ae.businessName]}),(0,_.jsx)(z.A,{children:(0,_.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,_.jsx)(c.A,{severity:"info",children:"This will create a new tenant with the same settings as the source tenant."}),(0,_.jsx)(h.A,{label:"Business Name",value:ie.businessName,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{businessName:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Subdomain",value:ie.subdomain,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{subdomain:e.target.value.toLowerCase()})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Contact Name",value:ie.contactName,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactName:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Contact Email",type:"email",value:ie.contactEmail,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactEmail:e.target.value})),required:!0,fullWidth:!0}),(0,_.jsx)(h.A,{label:"Contact Phone",value:ie.contactPhone,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{contactPhone:e.target.value})),fullWidth:!0})]})}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>{ee(!1),ce()},children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{if(ae)try{B("");const e=await fetch("".concat(oe,"/api/super-admin/tenants/").concat(ae.id,"/clone"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("superAdminAccessToken"))},body:JSON.stringify(ie)});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to clone tenant")}O("Tenant cloned successfully!"),ee(!1),ce(),re()}catch(e){B(e.message)}},variant:"contained",children:"Clone"})]})]}),(0,_.jsxs)(w.A,{open:ne,onClose:()=>te(!1),maxWidth:"sm",fullWidth:!0,children:[(0,_.jsxs)(E.A,{children:["Edit Flags: ",null===ae||void 0===ae?void 0:ae.businessName]}),(0,_.jsx)(z.A,{children:(0,_.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.isProduction,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{isProduction:e.target.checked}))}),label:"Production Account (protected from deletion)"}),(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.isTemplate,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{isTemplate:e.target.checked}))}),label:"Template (can be cloned)"}),(0,_.jsx)(k.A,{control:(0,_.jsx)(W.A,{checked:ie.gingrSyncEnabled,onChange:e=>le((0,a.A)((0,a.A)({},ie),{},{gingrSyncEnabled:e.target.checked}))}),label:"Enable Gingr Sync"})]})}),(0,_.jsxs)(N.A,{children:[(0,_.jsx)(r.A,{onClick:()=>{te(!1),ce()},children:"Cancel"}),(0,_.jsx)(r.A,{onClick:async()=>{if(ae)try{B("");const e=await fetch("".concat(oe,"/api/super-admin/tenants/").concat(ae.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("superAdminAccessToken"))},body:JSON.stringify({isProduction:ie.isProduction,isTemplate:ie.isTemplate,gingrSyncEnabled:ie.gingrSyncEnabled})});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to update tenant")}O("Tenant updated successfully!"),te(!1),ce(),re()}catch(e){B(e.message)}},variant:"contained",children:"Save"})]})]})]})}}}]);
"use strict";(self.webpackChunktailtown_frontend=self.webpackChunktailtown_frontend||[]).push([[757],{70757:(e,r,n)=>{n.r(r),n.d(r,{default:()=>O});var s=n(9950),i=n(62999),t=n(78317),l=n(10226),c=n(52432),a=n(36080),o=n(82053),d=n(65429),u=n(2235),h=n(1320),x=n(15769),A=n(69780),j=n(9213),p=n(21671),g=n(34075),m=n(46639),v=n(25333),y=n(6258),C=n(28429),f=n(42074),b=n(7999),S=n(57988),P=n(99532),w=n(63189),T=n(41084),k=n(96583),E=n(40033),R=n(28170),N=n(6493),_=n(79739),I=n(44414);const M=e=>{let{open:r,title:n,content:s,onClose:i,onConfirm:t,confirmText:c="Confirm",cancelText:a="Cancel"}=e;return(0,I.jsxs)(k.A,{open:r,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,I.jsx)(E.A,{id:"alert-dialog-title",children:n}),(0,I.jsx)(R.A,{children:(0,I.jsx)(N.A,{id:"alert-dialog-description",children:s})}),(0,I.jsxs)(_.A,{children:[(0,I.jsx)(l.A,{onClick:i,color:"primary",children:a}),(0,I.jsx)(l.A,{onClick:t,color:"primary",variant:"contained",autoFocus:!0,children:c})]})]})},O=()=>{const[e,r]=(0,s.useState)([]),[n,k]=(0,s.useState)(!0),[E,R]=(0,s.useState)(""),[N,_]=(0,s.useState)(0),[O,D]=(0,s.useState)(10),[z,F]=(0,s.useState)(0),[U,L]=(0,s.useState)(!1),[W,Y]=(0,s.useState)(null),G=(0,C.Zp)(),V=(0,s.useCallback)(async()=>{k(!0);try{const e=await T.A.getAllPriceRules({page:N+1,limit:O});r(e.data),F(e.totalPages*O),R("")}catch(s){var e,n;console.error("Error fetching price rules:",s),R((null===(e=s.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||"Failed to load price rules"),r([])}finally{k(!1)}},[N,O]);(0,s.useEffect)(()=>{V()},[V,N,O]);const B=e=>{switch(e.ruleType){case"DAY_OF_WEEK":return"Day of Week";case"MULTI_DAY":return"Multi-Day Stay";case"MULTI_PET":return"Multiple Pets";case"SEASONAL":return"Seasonal";case"PROMOTIONAL":return"Promotional";case"CUSTOM":return"Custom";default:return e.ruleType}},H=e=>{const r="SURCHARGE"===e.adjustmentType?"+":"-";return"PERCENTAGE"===e.discountType?"".concat(r).concat(e.discountValue,"%"):"".concat(r,"$").concat(e.discountValue.toFixed(2))};return(0,I.jsxs)(i.A,{maxWidth:"lg",children:[(0,I.jsxs)(t.A,{sx:{mt:4,mb:4},children:[(0,I.jsxs)(t.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,I.jsx)(l.A,{component:f.N_,to:"/settings",startIcon:(0,I.jsx)(w.A,{}),sx:{mr:2},children:"Back"}),(0,I.jsxs)(t.A,{children:[(0,I.jsxs)(c.A,{"aria-label":"breadcrumb",sx:{mb:1},children:[(0,I.jsx)(a.A,{component:f.N_,to:"/settings",color:"inherit",children:"Settings"}),(0,I.jsx)(o.A,{color:"text.primary",children:"Price Rules"})]}),(0,I.jsx)(o.A,{variant:"h4",component:"h1",children:"Price Rules"})]})]}),(0,I.jsx)(o.A,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Manage pricing rules for services. Create discounts to reduce prices or surcharges to increase prices based on days of the week, multi-day stays, or multiple pets."}),E&&(0,I.jsx)(d.A,{severity:"error",sx:{mb:3},children:E}),(0,I.jsx)(t.A,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:(0,I.jsx)(l.A,{variant:"contained",color:"primary",startIcon:(0,I.jsx)(P.A,{}),onClick:()=>G("/settings/price-rules/new"),children:"Add Rule"})}),(0,I.jsxs)(u.A,{sx:{width:"100%",overflow:"hidden"},children:[(0,I.jsx)(h.A,{children:(0,I.jsxs)(x.A,{children:[(0,I.jsx)(A.A,{children:(0,I.jsxs)(j.A,{children:[(0,I.jsx)(p.A,{children:"Name"}),(0,I.jsx)(p.A,{children:"Type"}),(0,I.jsx)(p.A,{children:"Discount"}),(0,I.jsx)(p.A,{children:"Applies To"}),(0,I.jsx)(p.A,{children:"Active"}),(0,I.jsx)(p.A,{align:"right",children:"Actions"})]})}),(0,I.jsx)(g.A,{children:n?(0,I.jsx)(j.A,{children:(0,I.jsx)(p.A,{colSpan:6,align:"center",children:(0,I.jsx)(m.A,{size:24})})}):0===(null===e||void 0===e?void 0:e.length)?(0,I.jsx)(j.A,{children:(0,I.jsx)(p.A,{colSpan:6,align:"center",children:"No price rules found"})}):e.map(e=>(0,I.jsxs)(j.A,{children:[(0,I.jsx)(p.A,{children:e.name}),(0,I.jsx)(p.A,{children:B(e)}),(0,I.jsx)(p.A,{children:H(e)}),(0,I.jsx)(p.A,{children:e.serviceCategories&&e.serviceCategories.length>0?(0,I.jsx)(o.A,{variant:"body2",children:e.serviceCategories.map(e=>e.serviceCategory).join(", ")}):e.services&&e.services.length>0?(0,I.jsx)(o.A,{variant:"body2",children:e.services.map(e=>{var r;return(null===(r=e.service)||void 0===r?void 0:r.name)||"Unknown"}).join(", ")}):(0,I.jsx)(o.A,{variant:"body2",children:"All Services"})}),(0,I.jsx)(p.A,{children:e.isActive?"Yes":"No"}),(0,I.jsxs)(p.A,{align:"right",children:[(0,I.jsx)(v.A,{onClick:()=>G("/settings/price-rules/".concat(e.id)),size:"small",children:(0,I.jsx)(b.A,{fontSize:"small"})}),(0,I.jsx)(v.A,{onClick:()=>{return r=e.id,Y(r),void L(!0);var r},size:"small",color:"error",children:(0,I.jsx)(S.A,{fontSize:"small"})})]})]},e.id))})]})}),(0,I.jsx)(y.A,{rowsPerPageOptions:[5,10,25],component:"div",count:z,rowsPerPage:O,page:N,onPageChange:(e,r)=>{_(r)},onRowsPerPageChange:e=>{D(parseInt(e.target.value,10)),_(0)}})]})]}),(0,I.jsx)(M,{open:U,title:"Confirm Deletion",content:"Are you sure you want to delete this price rule? This action cannot be undone.",onClose:()=>L(!1),onConfirm:async()=>{if(W)try{await T.A.deletePriceRule(W),V(),L(!1),Y(null)}catch(n){var e,r;console.error("Error deleting price rule:",n),R((null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Failed to delete price rule")}}})]})}}}]);